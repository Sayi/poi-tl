= Poi-tl Documentation
Sayi <sayi90@163.com>
v1.10.3
:description: wordæ¨¡æ¿å¼•æ“
:keywords: poi,word,docx,template,æ¨¡æ¿,å¯¼å‡º,å›¾è¡¨,åˆå¹¶
:doctype: book
:encoding: utf-8
:lang: en
:toc: left
// :toclevels: 3
:icons: font
// :source-highlighter: rouge
// :rouge-style: monokai
:source-highlighter: highlightjs
:highlightjs-theme: zenburn
:highlightjs-languages: groovy
:numbered:
// :nofooter:
:sectlinks:
:sectanchors:
:imagesdir: ../
// :stylesheet: asciidoctor.css
// :linkcss:

[example]
--
å…³äºæ–‡æ¡£ï¼špoi-tl v1.10.xæ˜¯æ„å»ºåœ¨Apache poi4.1.2å’ŒJDK1.8+ä¸Šçš„ç‰ˆæœ¬ï¼Œä¼šæŒç»­è¿›è¡Œä¼˜åŒ–å’Œbugfixï¼Œå¦‚æœå¸Œæœ›ä½¿ç”¨Apache poi5.1.0+ï¼Œæ¨èä½¿ç”¨poi-tlæœ€æ–°ç‰ˆæœ¬ï¼šlink:http://deepoove.com/poi-tl[poi-tl æœ€æ–°æ–‡æ¡£, window=_blank]ã€‚
--

poi-tlï¼ˆpoi template languageï¼‰æ˜¯Wordæ¨¡æ¿å¼•æ“ï¼Œä½¿ç”¨Wordæ¨¡æ¿å’Œæ•°æ®åˆ›å»ºå¾ˆæ£’çš„Wordæ–‡æ¡£ã€‚

[quote]
____
åœ¨æ–‡æ¡£çš„ä»»ä½•åœ°æ–¹åšä»»ä½•äº‹æƒ…ï¼ˆ_Do Anything Anywhere_ï¼‰æ˜¯poi-tlçš„æ˜Ÿè¾°å¤§æµ·ã€‚
____

== Why poi-tl
[options="header", stripes=none]
|===
| æ–¹æ¡ˆ | ç§»æ¤æ€§ |  åŠŸèƒ½æ€§  | æ˜“ç”¨æ€§
| **Poi-tl** | Javaè·¨å¹³å° | Wordæ¨¡æ¿å¼•æ“ | åŸºäºApache POIï¼Œæ›´å‹å¥½çš„API
| Apache POI | Javaè·¨å¹³å° | Apacheé¡¹ç›®ï¼Œä¸ä»…å°è£…äº†æ˜“ç”¨çš„æ–‡æ¡£API(æ–‡æœ¬ã€å›¾ç‰‡ã€è¡¨æ ¼ã€é¡µçœ‰ã€é¡µè„šã€å›¾è¡¨ç­‰)ï¼Œä¹Ÿå¯ä»¥åœ¨åº•å±‚ç›´æ¥æ“ä½œXMLç»“æ„ | æ–‡æ¡£ä¸å…¨ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ•™ç¨‹ï¼šlink:http://deepoove.com/poi-tl/apache-poi-guide.html[Apache POI Wordå¿«é€Ÿå…¥é—¨ , window=_blank]
| Freemarker | XMLè·¨å¹³å° | ä»…æ”¯æŒæ–‡æœ¬ï¼Œå¾ˆå¤§çš„å±€é™æ€§ | ä¸æ¨èï¼Œéœ€è¦ç»´æŠ¤XMLç»“æ„ï¼Œä»£ç åæœŸä¸å¯ç»´æŠ¤
| OpenOffice | éƒ¨ç½²OpenOfficeï¼Œç§»æ¤æ€§è¾ƒå·® | - | éœ€è¦äº†è§£OpenOfficeçš„API
| HTMLæµè§ˆå™¨å¯¼å‡º | ä¾èµ–æµè§ˆå™¨çš„å®ç°ï¼Œç§»æ¤æ€§è¾ƒå·® | HTMLä¸èƒ½å¾ˆå¥½çš„å…¼å®¹Wordçš„æ ¼å¼ | -
| Jacobã€winlib | Windowså¹³å° | - | å¤æ‚ï¼Œå®Œå…¨ä¸æ¨èä½¿ç”¨
|===

== ç‰¹æ€§
**poi-tl**æ­£æ˜¯ä¸€ä¸ªåŸºäºApache POIçš„Wordæ¨¡æ¿å¼•æ“ï¼Œå¹¶ä¸”æ‹¥æœ‰ç€è®©äººå–œæ‚¦çš„ç‰¹æ€§ã€‚

[cols=",", options="header"]
|===
|å¼•æ“åŠŸèƒ½ |æè¿°
|icon:check-circle[role="green"]æ–‡æœ¬ |å°†æ ‡ç­¾æ¸²æŸ“ä¸ºæ–‡æœ¬
|icon:check-circle[role="green"]å›¾ç‰‡ |å°†æ ‡ç­¾æ¸²æŸ“ä¸ºå›¾ç‰‡
|icon:check-circle[role="green"]è¡¨æ ¼ |å°†æ ‡ç­¾æ¸²æŸ“ä¸ºè¡¨æ ¼
|icon:check-circle[role="green"]åˆ—è¡¨ |å°†æ ‡ç­¾æ¸²æŸ“ä¸ºåˆ—è¡¨
|icon:check-circle[role="green"]å›¾è¡¨ |æ¡å½¢å›¾ï¼ˆ3Dæ¡å½¢å›¾ï¼‰ã€æŸ±å½¢å›¾ï¼ˆ3DæŸ±å½¢å›¾ï¼‰ã€é¢ç§¯å›¾ï¼ˆ3Dé¢ç§¯å›¾ï¼‰ã€æŠ˜çº¿å›¾ï¼ˆ3DæŠ˜çº¿å›¾ï¼‰ã€é›·è¾¾å›¾ã€é¥¼å›¾ï¼ˆ3Dé¥¼å›¾ï¼‰ç­‰å›¾è¡¨æ¸²æŸ“
|icon:check-circle[role="green"]If Conditionåˆ¤æ–­ |éšè—æˆ–è€…æ˜¾ç¤ºæŸäº›æ–‡æ¡£å†…å®¹ï¼ˆåŒ…æ‹¬æ–‡æœ¬ã€æ®µè½ã€å›¾ç‰‡ã€è¡¨æ ¼ã€åˆ—è¡¨ã€å›¾è¡¨ç­‰ï¼‰
|icon:check-circle[role="green"]Foreach Loopå¾ªç¯ |å¾ªç¯æŸäº›æ–‡æ¡£å†…å®¹ï¼ˆåŒ…æ‹¬æ–‡æœ¬ã€æ®µè½ã€å›¾ç‰‡ã€è¡¨æ ¼ã€åˆ—è¡¨ã€å›¾è¡¨ç­‰ï¼‰
|icon:check-circle[role="green"]Loopè¡¨æ ¼è¡Œ |å¾ªç¯å¤åˆ¶æ¸²æŸ“è¡¨æ ¼çš„æŸä¸€è¡Œ
|icon:check-circle[role="green"]Loopè¡¨æ ¼åˆ— |å¾ªç¯å¤åˆ¶æ¸²æŸ“è¡¨æ ¼çš„æŸä¸€åˆ—
|icon:check-circle[role="green"]Loopæœ‰åºåˆ—è¡¨ |æ”¯æŒæœ‰åºåˆ—è¡¨çš„å¾ªç¯ï¼ŒåŒæ—¶æ”¯æŒå¤šçº§åˆ—è¡¨
|icon:check-circle[role="green"]ä»£ç é«˜äº® |wordä¸­ä»£ç å—é«˜äº®å±•ç¤ºï¼Œæ”¯æŒ26ç§è¯­è¨€å’Œä¸Šç™¾ç§ç€è‰²æ ·å¼
|icon:check-circle[role="green"]Markdown |å°†Markdownæ¸²æŸ“ä¸ºwordæ–‡æ¡£
|icon:check-circle[role="green"]Wordæ‰¹æ³¨ |å®Œæ•´çš„æ‰¹æ³¨åŠŸèƒ½ï¼Œåˆ›å»ºæ‰¹æ³¨ã€ä¿®æ”¹æ‰¹æ³¨ç­‰
|icon:check-circle[role="green"]Wordé™„ä»¶ |Wordä¸­æ’å…¥é™„ä»¶
|icon:check-circle[role="green"]å›¾ç‰‡æ›¿æ¢ |å°†åŸæœ‰å›¾ç‰‡æ›¿æ¢æˆå¦ä¸€å¼ å›¾ç‰‡
|icon:check-circle[role="green"]ä¹¦ç­¾ã€é”šç‚¹ã€è¶…é“¾æ¥ |æ”¯æŒè®¾ç½®ä¹¦ç­¾ï¼Œæ–‡æ¡£å†…é”šç‚¹å’Œè¶…é“¾æ¥åŠŸèƒ½
|icon:check-circle[role="green"]Expression Language |å®Œå…¨æ”¯æŒSpringELè¡¨è¾¾å¼ï¼Œå¯ä»¥æ‰©å±•æ›´å¤šçš„è¡¨è¾¾å¼ï¼šOGNL, MVEL...
|icon:check-circle[role="green"]æ ‡ç­¾å®šåˆ¶ |æ”¯æŒè‡ªå®šä¹‰æ ‡ç­¾å‰åç¼€
|icon:check-circle[role="green"]æ–‡æœ¬æ¡† |æ–‡æœ¬æ¡†å†…æ ‡ç­¾æ”¯æŒ
|icon:check-circle[role="green"]æ ·å¼ |æ¨¡æ¿å³æ ·å¼ï¼ŒåŒæ—¶ä»£ç ä¹Ÿå¯ä»¥è®¾ç½®æ ·å¼
|icon:check-circle[role="green"]æ¨¡æ¿åµŒå¥— |æ¨¡æ¿åŒ…å«å­æ¨¡æ¿ï¼Œå­æ¨¡æ¿å†åŒ…å«å­æ¨¡æ¿
|icon:check-circle[role="green"]åˆå¹¶ |Wordåˆå¹¶Mergeï¼Œä¹Ÿå¯ä»¥åœ¨æŒ‡å®šä½ç½®è¿›è¡Œåˆå¹¶
|icon:check-circle[role="green"]ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°(æ’ä»¶) |åœ¨æ–‡æ¡£ä»»ä½•ä½ç½®æ‰§è¡Œå‡½æ•°
|===

poi-tlæ˜¯ä¸€ä¸ªå…è´¹å¼€æºçš„Javaç±»åº“ï¼Œä½ å¯ä»¥éå¸¸æ–¹ä¾¿çš„åŠ å…¥åˆ°ä½ çš„é¡¹ç›®ä¸­ã€‚

== è½¯ä»¶è¦æ±‚
* Apache POI 4.1.2
* JDK 1.8+

== å†å²ç‰ˆæœ¬
ç‚¹å‡»ä¸‹æ–¹é“¾æ¥æŸ¥é˜…poi-tlå†å²ç‰ˆæœ¬æ–‡æ¡£ï¼Œå…¶ä¸­v1.5.xæ˜¯æ„å»ºåœ¨Apache poi3.16+å’ŒJDK1.6+ä¸Šçš„ç‰ˆæœ¬ï¼Œé€‚ç”¨äºæ— æ³•å‡çº§poiçš„å¤è€é¡¹ç›®ã€‚

* link:http://deepoove.com/poi-tl/1.9.x/[1.9.x Documentation , window=_blank]
* link:http://deepoove.com/poi-tl/1.8.x/[1.8.x Documentation , window=_blank]
* link:http://deepoove.com/poi-tl/1.7.x/[1.7.x Documentation , window=_blank]
* link:http://deepoove.com/poi-tl/1.6.x/[1.6.x Documentation , window=_blank]
* link:http://deepoove.com/poi-tl/1.5.x/[1.5.x Documentation, window=_blank]

== Getting Started
=== Maven
[source, xml]
----
<dependency>
  <groupId>com.deepoove</groupId>
  <artifactId>poi-tl</artifactId>
  <version>1.10.3</version>
</dependency>
----

=== Gradle 
[source, groovy]
implementation 'com.deepoove:poi-tl:1.10.3'

=== 2åˆ†é’Ÿå¿«é€Ÿå…¥é—¨
æ–°å»ºWordæ–‡æ¡£template.docxï¼ŒåŒ…å«æ ‡ç­¾ `{{title}}` 
[example]
--
.template.docx 
{{title}}
--

[example]
--
.ä»£ç ç¤ºä¾‹
[source, java]
----
XWPFTemplate template = XWPFTemplate.compile("template.docx").render(
  new HashMap<String, Object>(){{
    put("title", "Hi, poi-tl Wordæ¨¡æ¿å¼•æ“");
}}); <1> <2>
template.writeAndClose(new FileOutputStream("output.docx")); <3>
----
<1> `compile` ç¼–è¯‘æ¨¡æ¿
<2> `render` æ¸²æŸ“æ•°æ®
<3> `write` è¾“å‡ºåˆ°æµ

*TDOæ¨¡å¼ï¼šTemplate + data-model = output*
--

[example]
--
.output.docx
Hi, poi-tl Wordæ¨¡æ¿å¼•æ“
--

=== Templateï¼šæ¨¡æ¿

æ¨¡æ¿æ˜¯Docxæ ¼å¼çš„Wordæ–‡æ¡£ï¼Œä½ å¯ä»¥ä½¿ç”¨Microsoft officeã€WPS Officeã€Pagesç­‰ä»»ä½•ä½ å–œæ¬¢çš„è½¯ä»¶åˆ¶ä½œæ¨¡æ¿ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Apache POIä»£ç æ¥ç”Ÿæˆæ¨¡æ¿ã€‚

æ‰€æœ‰çš„æ ‡ç­¾éƒ½æ˜¯ä»¥``{{``å¼€å¤´ï¼Œä»¥``}}``ç»“å°¾ï¼Œæ ‡ç­¾å¯ä»¥å‡ºç°åœ¨ä»»ä½•ä½ç½®ï¼ŒåŒ…æ‹¬é¡µçœ‰ï¼Œé¡µè„šï¼Œè¡¨æ ¼å†…éƒ¨ï¼Œæ–‡æœ¬æ¡†ç­‰ï¼Œè¡¨æ ¼å¸ƒå±€å¯ä»¥è®¾è®¡å‡ºå¾ˆå¤šä¼˜ç§€ä¸“ä¸šçš„æ–‡æ¡£ï¼Œæ¨èä½¿ç”¨è¡¨æ ¼å¸ƒå±€ã€‚

poi-tlæ¨¡æ¿éµå¾ª**â€œæ‰€è§å³æ‰€å¾—â€**çš„è®¾è®¡ï¼Œæ¨¡æ¿å’Œæ ‡ç­¾çš„æ ·å¼ä¼šè¢«å®Œå…¨ä¿ç•™ã€‚


=== Data-modelï¼šæ•°æ®

æ•°æ®ç±»ä¼¼äºå“ˆå¸Œæˆ–è€…å­—å…¸ï¼Œå¯ä»¥æ˜¯Mapç»“æ„ï¼ˆkeyæ˜¯æ ‡ç­¾åç§°ï¼‰ï¼š
[source, java]
----
Map<String, Object> data = new HashMap<>();
data.put("name", "Sayi");
data.put("start_time", "2019-08-04");
----

å¯ä»¥æ˜¯å¯¹è±¡ï¼ˆå±æ€§åæ˜¯æ ‡ç­¾åç§°ï¼‰ï¼š
[source, java]
----
public class Data {
  private String name;
  private String startTime;
  private Author author;
}
----

TIP: æ•°æ®å¯ä»¥æ˜¯æ ‘ç»“æ„ï¼Œæ¯çº§ä¹‹é—´ç”¨ç‚¹æ¥åˆ†éš”å¼€ï¼Œæ¯”å¦‚``{{author.name}}``æ ‡ç­¾å¯¹åº”çš„æ•°æ®æ˜¯authorå¯¹è±¡çš„nameå±æ€§å€¼ã€‚

FreeMarkerã€Velocityæ–‡æœ¬æ¨¡æ¿ä¸­å¯ä»¥é€šè¿‡ä¸‰ä¸ªæ ‡ç­¾è®¾ç½®å›¾ç‰‡è·¯å¾„ã€å®½å’Œé«˜ï¼š
[source, html]
<img src="{{path}}" width="{{width}}" height="{{height}}">

ä½†æ˜¯Wordæ¨¡æ¿ä¸æ˜¯ç”±ç®€å•çš„æ–‡æœ¬è¡¨ç¤ºï¼Œæ‰€ä»¥åœ¨æ¸²æŸ“å›¾ç‰‡ã€è¡¨æ ¼ç­‰å…ƒç´ æ—¶æä¾›äº†æ•°æ®æ¨¡å‹ï¼Œå®ƒä»¬éƒ½å®ç°äº†æ¥å£RenderDataï¼Œæ¯”å¦‚å›¾ç‰‡æ•°æ®æ¨¡å‹PictureRenderDataåŒ…å«å›¾ç‰‡è·¯å¾„ã€å®½ã€é«˜ä¸‰ä¸ªå±æ€§ã€‚

=== Outputï¼šè¾“å‡º
ä»¥æµçš„æ–¹å¼è¿›è¡Œè¾“å‡ºï¼š

[source, java]
----
template.write(OutputStream stream);
----

å¯ä»¥å†™åˆ°ä»»æ„è¾“å‡ºæµä¸­ï¼Œæ¯”å¦‚æ–‡ä»¶æµï¼š

[source, java]
----
template.write(new FileOutputStream("output.docx"));
----

æ¯”å¦‚ç½‘ç»œæµï¼š
[source, java]
----
response.setContentType("application/octet-stream");
response.setHeader("Content-disposition","attachment;filename=\""+"out_template.docx"+"\"");  

// HttpServletResponse response
OutputStream out = response.getOutputStream();
BufferedOutputStream bos = new BufferedOutputStream(out);
template.write(bos);
bos.flush();
out.flush();
PoitlIOUtils.closeQuietlyMulti(template, bos, out);
----
**æœ€åä¸è¦å¿˜è®°å…³é—­è¿™äº›æµã€‚**

== æ ‡ç­¾
poi-tlæ˜¯ä¸€ç§æ— é€»è¾‘ã€Œlogic-lessã€çš„æ¨¡æ¿å¼•æ“ï¼Œæ²¡æœ‰å¤æ‚çš„æ§åˆ¶ç»“æ„å’Œå˜é‡èµ‹å€¼ï¼Œåªæœ‰æ ‡ç­¾ã€‚æ ‡ç­¾ç”±å‰åä¸¤ä¸ªå¤§æ‹¬å·ç»„æˆï¼Œ{{title}}æ˜¯æ ‡ç­¾ï¼Œ{{?title}}ä¹Ÿæ˜¯æ ‡ç­¾ï¼Œtitleæ˜¯è¿™ä¸ªæ ‡ç­¾çš„åç§°ï¼Œé—®å·æ ‡è¯†äº†æ ‡ç­¾ç±»å‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹æœ‰å“ªäº›é»˜è®¤æ ‡ç­¾ç±»å‹ï¼ˆç”¨æˆ·å¯ä»¥åˆ›å»ºæ–°çš„æ ‡ç­¾ç±»å‹ï¼Œè¿™å±äºæ›´é«˜çº§çš„è¯é¢˜ï¼‰ã€‚

=== æ–‡æœ¬
[example]
--
{{var}}
--

æ•°æ®æ¨¡å‹ï¼š

- `String` ï¼šæ–‡æœ¬
- `TextRenderData` ï¼šæœ‰æ ·å¼çš„æ–‡æœ¬
- `HyperlinkTextRenderData` ï¼šè¶…é“¾æ¥å’Œé”šç‚¹æ–‡æœ¬
- `Object` ï¼šè°ƒç”¨ toString() æ–¹æ³•è½¬åŒ–ä¸ºæ–‡æœ¬

[sidebar]
.ä»£ç ç¤ºä¾‹
--
[source, java]
----
put("name", "Sayi");
put("author", new TextRenderData("000000", "Sayi"));
put("link", new HyperlinkTextRenderData("website", "http://deepoove.com"));
put("anchor", new HyperlinkTextRenderData("anchortxt", "anchor:appendix1"));
----
--

é™¤äº†newæ“ä½œç¬¦ï¼Œè¿˜æä¾›äº†æ›´åŠ ä¼˜é›…çš„å·¥å‚ `Texts` å’Œé“¾å¼è°ƒç”¨çš„æ–¹å¼è½»æ¾æ„å»ºæ–‡æœ¬æ¨¡å‹ã€‚
[sidebar]
.é“¾å¼ä»£ç ç¤ºä¾‹
--
[source, java]
----
put("name", "Sayi");
put("author", Texts.of("Sayi").color("000000").create());
put("link", Texts.of("website").link("http://deepoove.com").create());
put("anchor", Texts.of("anchortxt").anchor("appendix1").create());
----
--

æ‰€è§å³æ‰€å¾—ï¼Œæ ‡ç­¾çš„æ ·å¼ä¼šåº”ç”¨åˆ°æ›¿æ¢åçš„æ–‡æœ¬ä¸Šï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»£ç è®¾å®šæ–‡æœ¬çš„æ ·å¼ã€‚

[sidebar]
.TextRenderDataçš„ç»“æ„ä½“
--
[source, json]
----
{
  "text": "Sayi",
  "style": {
    "strike": false, <1>
    "bold": true, <2>
    "italic": false, <3>
    "color": "00FF00", <4>
    "underLine": false, <5>
    "fontFamily": "å¾®è½¯é›…é»‘", <6>
    "fontSize": 12, <7>
    "highlightColor": "green", <8>
    "vertAlign": "superscript", <9>
    "characterSpacing" : 20 <10>
  }
}
----
<1> åˆ é™¤çº¿
<2> ç²—ä½“
<3> æ–œä½“
<4> é¢œè‰²
<5> ä¸‹åˆ’çº¿
<6> å­—ä½“
<7> å­—å·
<8> èƒŒæ™¯é«˜äº®è‰²
<9> ä¸Šæ ‡æˆ–è€…ä¸‹æ ‡
<10> é—´è·
--
TIP: æ–‡æœ¬æ¢è¡Œä½¿ç”¨ `\n` å­—ç¬¦ã€‚

=== å›¾ç‰‡
[example]
å›¾ç‰‡æ ‡ç­¾ä»¥@å¼€å§‹ï¼š{{@var}}

æ•°æ®æ¨¡å‹ï¼š

- `String` ï¼šå›¾ç‰‡urlæˆ–è€…æœ¬åœ°è·¯å¾„ï¼Œé»˜è®¤ä½¿ç”¨å›¾ç‰‡è‡ªèº«å°ºå¯¸
- `PictureRenderData`

æ¨èä½¿ç”¨å·¥å‚ `Pictures` æ„å»ºå›¾ç‰‡æ¨¡å‹ã€‚
[sidebar]
.ä»£ç ç¤ºä¾‹
--
[source, java]
----
// æŒ‡å®šå›¾ç‰‡è·¯å¾„
put("image", "logo.png");

// è®¾ç½®å›¾ç‰‡å®½é«˜
put("image1", Pictures.ofLocal("logo.png").size(120, 120).create());

// å›¾ç‰‡æµ
put("streamImg", Pictures.ofStream(new FileInputStream("logo.jpeg"), PictureType.JPEG)
  .size(100, 120).create());

// ç½‘ç»œå›¾ç‰‡(æ³¨æ„ç½‘ç»œè€—æ—¶å¯¹ç³»ç»Ÿå¯èƒ½çš„æ€§èƒ½å½±å“) 
put("urlImg", Pictures.ofUrl("http://deepoove.com/images/icecream.png")
  .size(100, 100).create());

// svgå›¾ç‰‡
put("svg", "https://img.shields.io/badge/jdk-1.6%2B-orange.svg");

// javaå›¾ç‰‡
put("buffered", Pictures.ofBufferedImage(bufferImage, PictureType.PNG)
  .size(100, 100).create());
----
--
å›¾ç‰‡æ”¯æŒBufferedImageï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Javaç”Ÿæˆå›¾è¡¨æ’å…¥åˆ°wordæ–‡æ¡£ä¸­ã€‚

[sidebar]
.PictureRenderDataçš„ç»“æ„ä½“
--
[source, json]
----
{
  "pictureType" : "PNG", <1>
  "pictureSupplier": () -> byte[], <2>
  "pictureStyle": {
    "width": 100, <3>
    "height": 100 <4>
  },
  "altMeta": "å›¾ç‰‡ä¸å­˜åœ¨" <5>
}
----
<1> å›¾ç‰‡ç±»å‹
<2> è¿è¡Œæ—¶è·å–å›¾ç‰‡byte[]å­—èŠ‚æ•°ç»„çš„å‡½æ•°
<3> å®½åº¦ï¼Œå•ä½æ˜¯åƒç´ 
<4> é«˜åº¦ï¼Œå•ä½æ˜¯åƒç´ 
<5> å½“æ— æ³•è·å–å›¾ç‰‡æ—¶å±•ç¤ºçš„æ–‡å­—
--

=== è¡¨æ ¼
[example]
è¡¨æ ¼æ ‡ç­¾ä»¥#å¼€å§‹ï¼š{{#var}}

æ•°æ®æ¨¡å‹ï¼š

- `TableRenderData`

æ¨èä½¿ç”¨å·¥å‚ `Tables` ã€ `Rows` å’Œ `Cells` æ„å»ºè¡¨æ ¼æ¨¡å‹ã€‚

[example]
.åŸºç¡€è¡¨æ ¼ç¤ºä¾‹
--
[source, java]
----
// ä¸€ä¸ª2è¡Œ2åˆ—çš„è¡¨æ ¼
put("table0", Tables.of(new String[][] { 
                new String[] { "00", "01" },
                new String[] { "10", "11" }
            }).border(BorderStyle.DEFAULT).create());
----
image::./table_simple.png[width=500]
--

[example]
.è¡¨æ ¼æ ·å¼ç¤ºä¾‹
--
[source, java]
----
// ç¬¬0è¡Œå±…ä¸­ä¸”èƒŒæ™¯ä¸ºè“è‰²çš„è¡¨æ ¼
RowRenderData row0 = Rows.of("å§“å", "å­¦å†").textColor("FFFFFF")
      .bgColor("4472C4").center().create();
RowRenderData row1 = Rows.create("æå››", "åšå£«");
put("table1", Tables.create(row0, row1));
----
image::./table_header.png[width=500]
--

[example]
.è¡¨æ ¼åˆå¹¶ç¤ºä¾‹
--
[source, java]
----
// åˆå¹¶ç¬¬1è¡Œæ‰€æœ‰å•å…ƒæ ¼çš„è¡¨æ ¼
RowRenderData row0 = Rows.of("åˆ—0", "åˆ—1", "åˆ—2").center().bgColor("4472C4").create();
RowRenderData row1 = Rows.create("æ²¡æœ‰æ•°æ®", null, null);
MergeCellRule rule = MergeCellRule.builder().map(Grid.of(1, 0), Grid.of(1, 2)).build();
put("table3", Tables.of(row0, row1).mergeRule(rule).create());
----
image::./table_merge.png[width=500]
--

TableRenderDataè¡¨æ ¼æ¨¡å‹åœ¨å•å…ƒæ ¼å†…å¯ä»¥å±•ç¤ºæ–‡æœ¬å’Œå›¾ç‰‡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æŒ‡å®šè¡¨æ ¼æ ·å¼ã€è¡Œæ ·å¼å’Œå•å…ƒæ ¼æ ·å¼ï¼Œè€Œä¸”åœ¨Nè¡ŒNåˆ—æ¸²æŸ“å®Œæˆåå¯ä»¥åº”ç”¨å•å…ƒæ ¼åˆå¹¶è§„åˆ™ **MergeCellRule** ï¼Œä»è€Œå®ç°æ›´å¤æ‚çš„è¡¨æ ¼ã€‚

[sidebar]
.TableRenderDataçš„ç»“æ„ä½“
--
[source, json]
----
{
  "rows": [ <1>
    {
      "cells": [ <2>
        {
          "paragraphs": [ <3>
            {
              "contents": [
                {
                  [TextRenderData] <4>
                },
                {
                  [PictureRenderData] <5>
                }
              ],
              "paragraphStyle": null <6>
            }
          ],
          "cellStyle": { <7>
            "backgroundColor": "00000",
            "vertAlign": "CENTER"
          }
        }
      ],
      "rowStyle": { <8>
        "height": 2.0f
      }
    }
  ],
  "tableStyle": { <9>
    "width": 14.63f, <10>
    "colWidths": null
  },
  "mergeRule": { <11>
    "mapping": {
      "0-0": "1-2"
    }
  }
}
----
<1> è¡Œæ•°æ®
<2> å•å…ƒæ ¼æ•°æ®
<3> å•å…ƒæ ¼å†…æ®µè½
<4> å•å…ƒæ ¼å†…æ–‡æœ¬
<5> å•å…ƒæ ¼å†…å›¾ç‰‡
<6> å•å…ƒæ ¼å†…æ®µè½æ–‡æœ¬çš„æ ·å¼ï¼šå¯¹é½
<7> å•å…ƒæ ¼æ ·å¼ï¼šå‚ç›´å¯¹é½æ–¹å¼ï¼ŒèƒŒæ™¯è‰²
<8> è¡Œæ ·å¼ï¼šè¡Œé«˜(å•ä½cm)
<9> è¡¨æ ¼æ ·å¼ï¼šè¡¨æ ¼å¯¹é½ã€è¾¹æ¡†æ ·å¼
<10> è¡¨æ ¼å®½åº¦(å•ä½cm)ï¼Œè¡¨æ ¼çš„æœ€å¤§å®½åº¦ = é¡µé¢å®½åº¦ - é¡µè¾¹è·å®½åº¦ * 2ï¼Œé¡µé¢å®½åº¦ä¸ºA4(20.99 * 29.6ï¼Œé¡µè¾¹è·ä¸º3.18 * 2.54)çš„æ–‡æ¡£æœ€å¤§è¡¨æ ¼å®½åº¦14.63cmã€‚
<11> å•å…ƒæ ¼åˆå¹¶è§„åˆ™ï¼Œæ¯”å¦‚ç¬¬0è¡Œç¬¬0åˆ—è‡³ç¬¬1è¡Œç¬¬2åˆ—å•å…ƒæ ¼åˆå¹¶
--

[TIP]
====
äº§å“éœ€æ±‚ä¸­è¡¨æ ¼çš„å¸ƒå±€å’Œæ ·å¼å¯èƒ½å¾ˆå¤æ‚ï¼Œå¯ä»¥å°è¯•ä¸€äº›å·²æœ‰è¡¨æ ¼æ’ä»¶æ¥è§£å†³ï¼Œå‚è§link:#plugin-list[å¯é€‰æ’ä»¶åˆ—è¡¨]ã€‚

æˆ‘ä»¬ä¹Ÿå¯ä»¥ç¼–å†™æ’ä»¶ï¼Œå®Œå…¨ç”±è‡ªå·±ç”Ÿæˆæ•´ä¸ªè¡¨æ ¼ï¼Œå‰ææ˜¯éœ€è¦ç†Ÿæ‚‰Apache POI XWPFTableç›¸å…³APIï¼Œä½†æ˜¯è‡ªç”±åº¦æœ€é«˜ï¼šå‚è§ link:#cus-policy-section[å¼€å‘ä¸€ä¸ªæ’ä»¶]ã€‚
====

=== åˆ—è¡¨
[example]
åˆ—è¡¨æ ‡ç­¾ä»¥*å¼€å§‹ï¼š{{*var}}

æ•°æ®æ¨¡å‹ï¼š

- `List<String>`
- `NumberingRenderData`

æ¨èä½¿ç”¨å·¥å‚ `Numberings` æ„å»ºç¼–å·æ¨¡å‹ã€‚
[sidebar]
.ä»£ç ç¤ºä¾‹
--
[source, java]
----
put("list", Numberings.create("Plug-in grammar",
                    "Supports word text, pictures, table...",
                    "Not just templates"));
----
--
ç¼–å·æ ·å¼æ”¯æŒç½—é©¬å­—ç¬¦ã€æœ‰åºæ— åºç­‰ï¼Œå¯ä»¥é€šè¿‡ `Numberings.of(NumberingFormat)` æ¥æŒ‡å®šã€‚
[source, java]
DECIMAL //1. 2. 3.
DECIMAL_PARENTHESES //1) 2) 3)
BULLET //â— â— â—
LOWER_LETTER //a. b. c.
LOWER_ROMAN //i â…± â…²
UPPER_LETTER //A. B. C.

[TIP]
====
NumberingRenderDataå¯ä»¥åˆ›å»ºå¤šçº§åˆ—è¡¨ï¼Œä½†æ˜¯æ¨èä½¿ç”¨åŒºå—å¯¹ï¼šåŒºå—å¯¹çš„å¾ªç¯åŠŸèƒ½å¯ä»¥å¾ˆå¥½çš„å¾ªç¯åˆ—è¡¨ï¼Œå¹¶ä¸”ä¿æŒæœ‰åºåˆ—è¡¨ç¼–å·æœ‰åºã€‚
====

=== åŒºå—å¯¹
[example]
åŒºå—å¯¹ç”±å‰åä¸¤ä¸ªæ ‡ç­¾ç»„æˆï¼Œå¼€å§‹æ ‡ç­¾ä»¥?æ ‡è¯†ï¼Œç»“æŸæ ‡ç­¾ä»¥/æ ‡è¯†ï¼š{{?sections}}{{/sections}}

åŒºå—å¯¹å¼€å§‹å’Œç»“æŸæ ‡ç­¾ä¸­é—´å¯ä»¥**åŒ…å«å¤šä¸ªå›¾ç‰‡ã€è¡¨æ ¼ã€æ®µè½ã€åˆ—è¡¨ã€å›¾è¡¨**ç­‰ï¼Œå¼€å§‹å’Œç»“æŸæ ‡ç­¾å¯ä»¥è·¨å¤šä¸ªæ®µè½ï¼Œä¹Ÿå¯ä»¥åœ¨åŒä¸€ä¸ªæ®µè½ï¼Œä½†æ˜¯å¦‚æœåœ¨è¡¨æ ¼ä¸­ä½¿ç”¨åŒºå—å¯¹ï¼Œå¼€å§‹å’Œç»“æŸæ ‡ç­¾å¿…é¡»åœ¨åŒä¸€ä¸ªå•å…ƒæ ¼å†…ï¼Œå› ä¸ºè·¨å¤šä¸ªå•å…ƒæ ¼çš„æ¸²æŸ“è¡Œä¸ºæ˜¯æœªçŸ¥çš„ã€‚

åŒºå—å¯¹åœ¨å¤„ç†ä¸€ç³»åˆ—æ–‡æ¡£å…ƒç´ çš„æ—¶å€™éå¸¸æœ‰ç”¨ï¼Œä½äºåŒºå—å¯¹ä¸­çš„æ–‡æ¡£å…ƒç´ å¯ä»¥è¢«æ¸²æŸ“é›¶æ¬¡ï¼Œä¸€æ¬¡æˆ–Næ¬¡ï¼Œè¿™å–å†³äºåŒºå—å¯¹çš„å–å€¼ã€‚

Falseæˆ–ç©ºé›†åˆ:: éšè—åŒºå—ä¸­çš„æ‰€æœ‰æ–‡æ¡£å…ƒç´ 
éFalseä¸”ä¸æ˜¯é›†åˆ:: æ˜¾ç¤ºåŒºå—ä¸­çš„æ–‡æ¡£å…ƒç´ ï¼Œæ¸²æŸ“ä¸€æ¬¡
éç©ºé›†åˆ:: æ ¹æ®é›†åˆçš„å¤§å°ï¼Œå¾ªç¯æ¸²æŸ“åŒºå—ä¸­çš„æ–‡æ¡£å…ƒç´ 

NOTE: é›†åˆæ˜¯æ ¹æ®å€¼çš„ç±»å‹æ˜¯å¦å®ç°äº† `Iterable` æ¥å£æ¥åˆ¤æ–­ã€‚

==== Falseæˆ–ç©ºé›†åˆ
å¦‚æœåŒºå—å¯¹çš„å€¼æ˜¯ null ã€false æˆ–è€…ç©ºçš„é›†åˆï¼Œä½äºåŒºå—ä¸­çš„æ‰€æœ‰æ–‡æ¡£å…ƒç´ å°†ä¸ä¼šæ˜¾ç¤ºï¼Œè¿™å°±ç­‰åŒäºifè¯­å¥çš„æ¡ä»¶ä¸º falseã€‚

[example]
--
.data-model
[source, json]
----
{
  "announce": false
}
----
--

[example]
--
.template.docx
Made it,Ma!{{?announce}}Top of the world!{{/announce}}

Made it,Ma!

{{?announce}}

Top of the world!ğŸ‹

{{/announce}}
--

[example]
--
.output.docx
Made it,Ma!

Made it,Ma!
--

#### éFalseä¸”ä¸æ˜¯é›†åˆ
å¦‚æœåŒºå—å¯¹çš„å€¼ä¸ä¸º null ã€ false ï¼Œä¸”ä¸æ˜¯é›†åˆï¼Œä½äºåŒºå—ä¸­çš„æ‰€æœ‰æ–‡æ¡£å…ƒç´ ä¼šè¢«æ¸²æŸ“ä¸€æ¬¡ï¼Œè¿™å°±ç­‰åŒäºifè¯­å¥çš„æ¡ä»¶ä¸º trueã€‚


[example]
--
.data-model
[source, json]
----
{
  "person": { "name": "Sayi" }
}
----
--

[example]
--
.template.docx
{{?person}}  

Hi {{name}}!

{{/person}}
--

[example]
--
.output.docx
Hi Sayi!
--

IMPORTANT: åŒºå—å¯¹ä¸­æ ‡ç­¾çš„ä½œç”¨åŸŸä¼šè¢«é™å®šåœ¨å½“å‰åŒºå—å¯¹å†…ï¼Œå½“ä¸”ä»…å½“åŒºå—å¯¹çš„å€¼æ˜¯``boolean``ç±»å‹ä¸”ä¸º``true``æ—¶ï¼Œè¿™äº›æ ‡ç­¾ä½œç”¨åŸŸæ‰ä¸ä¼šæ”¹å˜ã€‚

#### éç©ºé›†åˆ
å¦‚æœåŒºå—å¯¹çš„å€¼æ˜¯ä¸€ä¸ªéç©ºé›†åˆï¼ŒåŒºå—ä¸­çš„æ–‡æ¡£å…ƒç´ ä¼šè¢«è¿­ä»£æ¸²æŸ“ä¸€æ¬¡æˆ–è€…Næ¬¡ï¼Œè¿™å–å†³äºé›†åˆçš„å¤§å°ï¼Œç±»ä¼¼äºforeachè¯­æ³•ã€‚

[example]
--
.data-model
[source, json]
----
{
  "songs": [
    { "name": "Memories" },
    { "name": "Sugar" },
    { "name": "Last Dance" }
  ]
}
----
--

[example]
--
.template.docx
{{?songs}}

{{name}}

{{/songs}}
--

[example]
--
.output.docx
Memories

Sugar

Last Dance
--

[sidebar]
.å¾ªç¯å†…ç½®å˜é‡
--
åœ¨å¾ªç¯ä¸­æä¾›äº†ä¸€äº›å†…ç½®å˜é‡ï¼Œè¿™äº›å†…ç½®å˜é‡åªèƒ½ç”¨äºåŒºå—å¯¹ä¸­ã€‚
[options="header", stripes=even]
|===
| å˜é‡ | ç±»å‹ |  è¯´æ˜  
| _index | int | è¿”å›å½“å‰è¿­ä»£ä»0å¼€å§‹çš„ç´¢å¼• 
| _is_first | boolean | è¾¨åˆ«å¾ªç¯é¡¹æ˜¯å¦æ˜¯å½“å‰è¿­ä»£çš„ç¬¬ä¸€é¡¹ã€‚ 
| _is_last | boolean | è¾¨åˆ«å¾ªç¯é¡¹æ˜¯å¦æ˜¯å½“å‰è¿­ä»£çš„æœ€åä¸€é¡¹ã€‚ 
| _has_next | boolean | è¾¨åˆ«å¾ªç¯é¡¹æ˜¯å¦æ˜¯æœ‰ä¸‹ä¸€é¡¹ã€‚ 
| _is_even_item | boolean | è¾¨åˆ«å¾ªç¯é¡¹æ˜¯å¦æ˜¯å½“å‰è¿­ä»£é—´éš”1çš„å¥‡æ•°é¡¹ã€‚ 
| _is_odd_item | boolean | è¾¨åˆ«å¾ªç¯é¡¹æ˜¯å¦æ˜¯å½“å‰è¿­ä»£é—´éš”1çš„å¶æ•°é¡¹ã€‚ 
| #this | object | å¼•ç”¨å½“å‰å¯¹è±¡ï¼Œç”±äº#å’Œå·²æœ‰è¡¨æ ¼æ ‡ç­¾æ ‡è¯†å†²çªï¼Œæ‰€ä»¥åœ¨æ–‡æœ¬æ ‡ç­¾ä¸­éœ€è¦ä½¿ç”¨=å·æ ‡è¯†æ¥è¾“å‡ºæ–‡æœ¬ã€‚ 
|===

ç¤ºä¾‹æ•°æ®:
```json
{
  "produces": [
    "application/json",
    "application/xml"
  ]
}
```

template.docx:

```
{{?produces}}
{{_index + 1}}. {{=#this}}
{{/produces}}
```

output.docx:

```html
1. application/json
2. application/xml
```
--

=== åµŒå¥—
[example]
åµŒå¥—åˆç§°ä¸ºå¯¼å…¥ã€åŒ…å«æˆ–è€…åˆå¹¶ï¼Œä»¥+æ ‡è¯†ï¼š{{+var}}

æ•°æ®æ¨¡å‹ï¼š

- `DocxRenderData`

æ¨èä½¿ç”¨å·¥å‚ `Includes` æ„å»ºåµŒå¥—æ¨¡å‹ã€‚
[sidebar]
.ä»£ç ç¤ºä¾‹
--
[source, java]
----
class AddrModel {
  private String addr;
  public AddrModel(String addr) {
    this.addr = addr;
  }
  // Getter/Setter
}

List<AddrModel> subData = new ArrayList<>();
subData.add(new AddrModel("Hangzhou,China"));
subData.add(new AddrModel("Shanghai,China"));
put("nested", Includes.ofLocal("sub.docx").setRenderModel(subData).create()); <1> <2>
----
<1> ä¸»æ¨¡æ¿åŒ…å«åµŒå¥—æ ‡ç­¾{{+nested}}
<2> sub.docxæ˜¯ä¸€ä¸ªåŒ…å«äº†{{addr}}çš„å­æ¨¡æ¿ï¼Œä½¿ç”¨subDataé›†åˆæ¸²æŸ“ååˆå¹¶åˆ°ä¸»æ¨¡æ¿
--

== å¼•ç”¨æ ‡ç­¾
å¼•ç”¨æ ‡ç­¾æ˜¯ä¸€ç§ç‰¹æ®Šä½ç½®çš„ç‰¹æ®Šæ ‡ç­¾ï¼Œæä¾›äº†ç›´æ¥å¼•ç”¨æ–‡æ¡£ä¸­çš„å…ƒç´ å¥æŸ„çš„èƒ½åŠ›ï¼Œ**è¿™ä¸ªé‡è¦çš„ç‰¹æ€§åœ¨æˆ‘ä»¬åªæƒ³æ”¹å˜æ–‡æ¡£ä¸­æŸä¸ªå…ƒç´ æå°ä¸€éƒ¨åˆ†æ ·å¼å’Œå±æ€§çš„æ—¶å€™ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå…¶ä½™æ ·å¼å’Œå±æ€§éƒ½å¯ä»¥åœ¨æ¨¡æ¿ä¸­é¢„ç½®å¥½ï¼ŒçœŸæ­£çš„æ‰€è§å³æ‰€å¾—**ã€‚

[#ref-policy-section]
=== å›¾ç‰‡

[example]
å¼•ç”¨å›¾ç‰‡æ ‡ç­¾æ˜¯ä¸€ä¸ªæ–‡æœ¬ï¼š{{var}}ï¼Œæ ‡ç­¾ä½ç½®åœ¨ï¼šè®¾ç½®å›¾ç‰‡æ ¼å¼--å¯é€‰æ–‡å­—--æ ‡é¢˜æˆ–è€…è¯´æ˜ï¼ˆæ–°ç‰ˆæœ¬Microsoft Officeæ ‡ç­¾ä½ç½®åœ¨ï¼šç¼–è¾‘æ›¿æ¢æ–‡å­—-æ›¿æ¢æ–‡å­—ï¼‰ã€‚

image::./ref2.png[align='center']

å¼•ç”¨å›¾ç‰‡æ ‡ç­¾åªä¼šæ›¿æ¢å›¾ç‰‡è€Œä¸ä¼šæ”¹å˜å›¾ç‰‡å°ºå¯¸å’Œå¸ƒå±€ï¼Œæ•°æ®æ¨¡å‹å’Œå›¾ç‰‡æ ‡ç­¾ä¸€è‡´ï¼š`PictureRenderData` ã€‚
[example]
--
.ä»£ç ç¤ºä¾‹
[source, java]
----
put("img", Pictures.ofLocal("sayi.png").create());
----
--

=== å¤šç³»åˆ—å›¾è¡¨
å¤šç³»åˆ—å›¾è¡¨æŒ‡çš„æ˜¯æ¡å½¢å›¾ï¼ˆ3Dæ¡å½¢å›¾ï¼‰ã€æŸ±å½¢å›¾ï¼ˆ3DæŸ±å½¢å›¾ï¼‰ã€é¢ç§¯å›¾ï¼ˆ3Dé¢ç§¯å›¾ï¼‰ã€æŠ˜çº¿å›¾ï¼ˆ3DæŠ˜çº¿å›¾ï¼‰ã€é›·è¾¾å›¾ç­‰ã€‚

[example]
å¤šç³»åˆ—å›¾è¡¨çš„æ ‡ç­¾æ˜¯ä¸€ä¸ªæ–‡æœ¬ï¼š{{var}}ï¼Œæ ‡ç­¾ä½ç½®åœ¨ï¼šå›¾è¡¨åŒºæ ¼å¼--å¯é€‰æ–‡å­—--æ ‡é¢˜ï¼ˆæ–°ç‰ˆæœ¬Microsoft Officeæ ‡ç­¾ä½ç½®åœ¨ï¼šç¼–è¾‘æ›¿æ¢æ–‡å­—-æ›¿æ¢æ–‡å­—ï¼‰ã€‚

image::./chartref.png[align='center']

æ•°æ®æ¨¡å‹ï¼š

- `ChartMultiSeriesRenderData`

æ¨èä½¿ç”¨å·¥å‚ `Charts` æ„å»ºå›¾è¡¨æ¨¡å‹ã€‚

[sidebar]
.ä»£ç ç¤ºä¾‹
--
[source, java]
----
ChartMultiSeriesRenderData chart = Charts
                .ofMultiSeries("ChartTitle", new String[] { "ä¸­æ–‡", "English" })
                .addSeries("countries", new Double[] { 15.0, 6.0 })
                .addSeries("speakers", new Double[] { 223.0, 119.0 })
                .create();

put("barChart", chart);
----
--

æ–°çš„å›¾è¡¨ç³»åˆ—æ•°æ®ä¼šå®Œå…¨æ›¿æ¢åŸæœ‰å›¾è¡¨æ•°æ®ï¼Œè€ŒåŸæœ‰å›¾è¡¨çš„æ ·å¼éƒ½ä¼šè¢«ä¿ç•™ã€‚

[sidebar]
.ChartMultiSeriesRenderDataçš„ç»“æ„ä½“
--
[source, json]
----
{
  "chartTitle": "ChartTitle", <1>
  "categories": [ <2>
    "ä¸­æ–‡", "English"
  ],
  "seriesDatas": [ <3>
    {
      "name": "countries", <4>
      "values": [ <5>
        15, 6
      ]
    },
    {
      "name": "speakers",
      "values": [
        223, 119
      ]
    }
  ]
}
----
<1> å›¾è¡¨æ ‡é¢˜
<2> ç§ç±»
<3> æ‰€æœ‰ç³»åˆ—
<4> å½“å‰ç³»åˆ—åç§°
<5> å½“å‰ç³»åˆ—å¯¹åº”æ¯ä¸ªç§ç±»çš„å€¼
--

=== å•ç³»åˆ—å›¾è¡¨
å•ç³»åˆ—å›¾è¡¨æŒ‡çš„æ˜¯é¥¼å›¾ï¼ˆ3Dé¥¼å›¾ï¼‰ã€åœ†ç¯å›¾ç­‰ã€‚

[example]
å•ç³»åˆ—å›¾è¡¨çš„æ ‡ç­¾æ˜¯ä¸€ä¸ªæ–‡æœ¬ï¼š{{var}}ï¼Œæ ‡ç­¾ä½ç½®åœ¨ï¼šå›¾è¡¨åŒºæ ¼å¼--å¯é€‰æ–‡å­—--æ ‡é¢˜ï¼ˆæ–°ç‰ˆæœ¬Microsoft Officeæ ‡ç­¾ä½ç½®åœ¨ï¼šç¼–è¾‘æ›¿æ¢æ–‡å­—-æ›¿æ¢æ–‡å­—ï¼‰ã€‚

image::./piechartref.png[align='center']

æ•°æ®æ¨¡å‹ï¼š

- `ChartSingleSeriesRenderData`

æ¨èä½¿ç”¨å·¥å‚ `Charts` æ„å»ºå›¾è¡¨æ¨¡å‹ã€‚
[sidebar]
.ä»£ç ç¤ºä¾‹
--
[source, java]
----
ChartSingleSeriesRenderData pie = Charts
                .ofSingleSeries("ChartTitle", new String[] { "ç¾å›½", "ä¸­å›½" })
                .series("countries", new Integer[] { 9826675, 9596961 })
                .create();

put("pieChart", pie);
----
--

[sidebar]
.ChartSingleSeriesRenderDataçš„ç»“æ„ä½“
--
[source, json]
----
{
  "chartTitle": "ChartTitle", <1>
  "categories": [ <2>
    "ç¾å›½",
    "ä¸­å›½"
  ],
  "seriesData": { <3>
    "name": "countries", <4>
    "values": [ <5>
      9826675,
      9596961
    ]
  }
}
----
<1> å›¾è¡¨æ ‡é¢˜
<2> ç§ç±»
<3> å•ç³»åˆ—
<4> å•ç³»åˆ—åç§°
<5> å•ç³»åˆ—å¯¹åº”æ¯ä¸ªç§ç±»çš„å€¼
--

=== ç»„åˆå›¾è¡¨
ç»„åˆå›¾è¡¨æŒ‡çš„æ˜¯ç”±å¤šç³»åˆ—å›¾è¡¨ï¼ˆæŸ±å½¢å›¾ã€æŠ˜çº¿å›¾ã€é¢ç§¯å›¾ï¼‰ç»„åˆè€Œæˆçš„å›¾è¡¨ã€‚

[example]
ç»„åˆå›¾è¡¨çš„æ ‡ç­¾æ˜¯ä¸€ä¸ªæ–‡æœ¬ï¼š{{var}}ï¼Œæ ‡ç­¾ä½ç½®åœ¨ï¼šå›¾è¡¨åŒºæ ¼å¼--å¯é€‰æ–‡å­—--æ ‡é¢˜ï¼ˆæ–°ç‰ˆæœ¬Microsoft Officeæ ‡ç­¾ä½ç½®åœ¨ï¼šç¼–è¾‘æ›¿æ¢æ–‡å­—-æ›¿æ¢æ–‡å­—ï¼‰ã€‚

image::./chart_combo.jpeg[align='center']

åŒå¤šç³»åˆ—å›¾è¡¨ `ChartMultiSeriesRenderData` æ•°æ®æ¨¡å‹ã€‚

[sidebar]
.ä»£ç ç¤ºä¾‹
--
[source, java]
----
ChartSingleSeriesRenderData comb = Charts
                .ofComboSeries("MyChart", new String[] { "ä¸­æ–‡", "English" })
                .addBarSeries("countries", new Double[] { 15.0, 6.0 })
                .addBarSeries("speakers", new Double[] { 223.0, 119.0 })
                .addBarSeries("NewBar", new Double[] { 223.0, 119.0 })
                .addLineSeries("youngs", new Double[] { 323.0, 89.0 })
                .addLineSeries("NewLine", new Double[] { 123.0, 59.0 }).create();

put("combChart", comb);
----
--

[sidebar]
.ChartMultiSeriesRenderDataçš„ç»“æ„ä½“
--
[source, json]
----
{
  "chartTitle": "MyChart", <1>
  "categories": [ <2>
    "ä¸­æ–‡", "English"
  ],
  "seriesDatas": [ <3>
    {
      "name": "countries", <4>
      "comboType": "BAR", <5>
      "values": [ <6>
        15, 6
      ]
    },
    {
      "name": "speakers",
      "comboType": "LINE",
      "values": [
        223, 119
      ]
    }
  ]
}
----
<1> å›¾è¡¨æ ‡é¢˜
<2> ç§ç±»
<3> æ‰€æœ‰ç³»åˆ—
<4> å½“å‰ç³»åˆ—åç§°
<5> å½“å‰ç³»åˆ—çš„å›¾è¡¨ç±»å‹comboTypeï¼šæŸ±å½¢å›¾BARã€æŠ˜çº¿å›¾LINEã€é¢ç§¯å›¾AREA
<6> å½“å‰ç³»åˆ—å¯¹åº”æ¯ä¸ªç§ç±»çš„å€¼
--

== é…ç½®
poi-tlæä¾›äº†ç±» `Configure` æ¥é…ç½®å¸¸ç”¨çš„è®¾ç½®ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
[source, java]
ConfigureBuilder builder = Configure.builder();
XWPFTemplate.compile("template.docx", builder.buid());

=== å‰åç¼€
æˆ‘ä¸€ç›´ä½¿ç”¨ `{{}}` çš„æ–¹å¼æ¥è‡´æ•¬Google CTemplateï¼Œå¦‚æœä½ æ›´åçˆ±freemarker `${}` çš„æ–¹å¼ï¼š
[source, java]
----
builder.buildGramer("${", "}");
----

=== æ ‡ç­¾ç±»å‹
é»˜è®¤çš„å›¾ç‰‡æ ‡ç­¾æ˜¯ä»¥@å¼€å§‹ï¼Œå¦‚æœä½ å¸Œæœ›ä½¿ç”¨%å¼€å§‹ä½œä¸ºå›¾ç‰‡æ ‡ç­¾ï¼š
[source, java]
builder.addPlugin('%', new PictureRenderPolicy());

å¦‚æœä½ ä¸æ˜¯å¾ˆå–œæ¬¢é»˜è®¤çš„æ ‡ç­¾æ ‡è¯†ç±»å‹ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªç”±æ›´æ”¹ï¼š
[source, java]
builder.addPlugin('@', new TableRenderPolicy());
builder.addPlugin('#', new PictureRenderPolicy());

è¿™æ ·{{@var}}å°±å˜æˆäº†è¡¨æ ¼æ ‡ç­¾ï¼Œ{{#var}}å˜æˆäº†å›¾ç‰‡æ ‡ç­¾ï¼Œè™½ç„¶ä¸å»ºè®®æ”¹å˜é»˜è®¤æ ‡ç­¾æ ‡è¯†ï¼Œä½†æ˜¯ä»ä¸­å¯ä»¥çœ‹åˆ°poi-tlæ’ä»¶çš„çµæ´»åº¦ï¼Œåœ¨æ’ä»¶ç« èŠ‚ä¸­æˆ‘ä»¬å°†ä¼šçœ‹åˆ°å¦‚ä½•è‡ªå®šä¹‰è‡ªå·±çš„æ ‡ç­¾ã€‚


=== æ ‡ç­¾åŒ¹é…
æ ‡ç­¾é»˜è®¤æ”¯æŒ**ä¸­æ–‡ã€å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿**çš„ç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æ¥é…ç½®æ ‡ç­¾çš„è§„åˆ™ï¼Œæ¯”å¦‚ä¸å…è®¸ä¸­æ–‡ï¼š
[source, java]
builder.buildGrammerRegex("[\\w]+(\\.[\\w]+)*");

æ¯”å¦‚å…è®¸é™¤äº†æ ‡ç­¾å‰åç¼€å¤–çš„ä»»æ„å­—ç¬¦ï¼š
[source, java]
builder.buildGrammerRegex(RegexUtils.createGeneral("{{", "}}"));

=== æ ‡ç­¾å€¼è®¡ç®—
æ ‡ç­¾å€¼è®¡ç®—æ˜¯æŒ‡å¦‚ä½•åœ¨æ•°æ®æ¨¡å‹ä¸­ç´¢å¼•æ ‡ç­¾Keyçš„å€¼ï¼Œå¯ä»¥å®Œå…¨è‡ªå®šä¹‰è·å–æ ‡ç­¾å€¼çš„æ–¹å¼ã€‚
[source, java]
----
builder.setRenderDataComputeFactory(new RenderDataComputeFactory());
----

TIP: RenderDataComputeFactoryæ˜¯ä¸€ä¸ªæŠ½è±¡å·¥å‚ï¼Œä½ å¯ä»¥å®šä¹‰è‡ªå·±çš„å·¥å‚æä¾›æ ‡ç­¾è¡¨è¾¾å¼è®¡ç®—æ¥å£ `RenderDataCompute` çš„å®ç°ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡æ­¤æ–¹å¼æ”¯æŒä»»ä½•çš„è¡¨è¾¾å¼å¼•æ“ï¼ŒSpringè¡¨è¾¾å¼æ­£æ˜¯é€šè¿‡ `SpELRenderDataCompute` å®ç°ã€‚

=== Springè¡¨è¾¾å¼
Spring Expression Language æ˜¯ä¸€ä¸ªå¼ºå¤§çš„è¡¨è¾¾å¼è¯­è¨€ï¼Œæ”¯æŒåœ¨è¿è¡Œæ—¶æŸ¥è¯¢å’Œæ“ä½œå¯¹è±¡å›¾ï¼Œå¯ä½œä¸ºç‹¬ç«‹ç»„ä»¶ä½¿ç”¨ï¼Œéœ€è¦å¼•å…¥ç›¸åº”çš„ä¾èµ–ï¼š
[source, xml]
----
<dependency>
  <groupId>org.springframework</groupId>
  <artifactId>spring-expression</artifactId>
  <version>4.3.6.RELEASE</version>
</dependency>
----

ä¸ºäº†åœ¨æ¨¡æ¿æ ‡ç­¾ä¸­ä½¿ç”¨SpringELè¡¨è¾¾å¼ï¼Œéœ€è¦å°†æ ‡ç­¾é…ç½®ä¸ºSpringELæ¨¡å¼ï¼š
[source, java]
----
builder.useSpringEL();
----

==== åŸºæœ¬ä½¿ç”¨
å…³äºSpringELçš„å†™æ³•å¯ä»¥å‚è§link:https://docs.spring.io/spring/docs/4.3.26.RELEASE/spring-framework-reference/htmlsingle/#expressions[å®˜æ–¹æ–‡æ¡£]ï¼Œä¸‹é¢ç»™å‡ºä¸€äº›å…¸å‹çš„ç¤ºä¾‹ã€‚
[example]
--
[source]
----
{{name}}
{{name.toUpperCase()}} <1>
{{name == 'poi-tl'}} <2>
{{empty?:'è¿™ä¸ªå­—æ®µä¸ºç©º'}}
{{sex ? 'ç”·' : 'å¥³'}} <3>
{{new java.text.SimpleDateFormat('yyyy-MM-dd HH:mm:ss').format(time)}} <4>
{{price/10000 + 'ä¸‡å…ƒ'}} <5>
{{dogs[0].name}} <6>
{{localDate.format(T(java.time.format.DateTimeFormatter).ofPattern('yyyyå¹´MMæœˆddæ—¥'))}} <7>
----
<1> ç±»æ–¹æ³•è°ƒç”¨ï¼Œè½¬å¤§å†™
<2> åˆ¤æ–­æ¡ä»¶
<3> ä¸‰ç›®è¿ç®—ç¬¦
<4> ç±»æ–¹æ³•è°ƒç”¨ï¼Œæ—¶é—´æ ¼å¼åŒ–
<5> è¿ç®—ç¬¦
<6> æ•°ç»„åˆ—è¡¨ä½¿ç”¨ä¸‹æ ‡è®¿é—®
<7> ä½¿ç”¨é™æ€ç±»æ–¹æ³•
--

==== SpringELä½œä¸ºåŒºå—å¯¹çš„æ¡ä»¶
Springè¡¨è¾¾å¼ä¸åŒºå—å¯¹ç»“åˆå¯ä»¥å®ç°æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚

[example]
--
.data-model
[source, json]
----
{
  "desc": "",
  "summary": "Find A Pet",
  "produces": [
    "application/xml"
  ]
}
----
--

[example]
--
.template.docx
{{?desc == null or desc == ''}}{{summary}}{{/}}

{{?produces == null or produces.size() == 0}}æ— {{/}}
--

[example]
--
.output.docx
Find A Pet
--


TIP: ä½¿ç”¨SpringELæ—¶åŒºå—å¯¹çš„ç»“æŸæ ‡ç­¾å¯ä»¥æ˜¯ï¼š{{/}}ã€‚

=== é”™è¯¯å¤„ç†
poi-tlæ”¯æŒåœ¨å‘ç”Ÿé”™è¯¯çš„æ—¶å€™å®šåˆ¶å¼•æ“çš„è¡Œä¸ºã€‚

==== æ ‡ç­¾æ— æ³•è¢«è®¡ç®—
æ ‡ç­¾æ— æ³•è¢«è®¡ç®—çš„åœºæ™¯æœ‰å‡ ç§ï¼Œæ¯”å¦‚æ¨¡æ¿ä¸­å¼•ç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨çš„å˜é‡ï¼Œæˆ–è€…çº§è”çš„å‰ç½®ç»“æœä¸æ˜¯ä¸€ä¸ªå“ˆå¸Œï¼Œå¦‚ `{{author.name}}` ä¸­authorçš„å€¼ä¸ºnullï¼Œæ­¤æ—¶å°±æ— æ³•è®¡ç®—nameçš„å€¼ã€‚

poi-tlå¯ä»¥åœ¨å‘ç”Ÿè¿™ç§é”™è¯¯æ—¶å¯¹è®¡ç®—ç»“æœè¿›è¡Œé…ç½®ï¼Œé»˜è®¤ä¼šè®¤ä¸ºæ ‡ç­¾å€¼ä¸º``null``ã€‚å½“æˆ‘ä»¬éœ€è¦ä¸¥æ ¼æ ¡éªŒæ¨¡æ¿æ˜¯å¦æœ‰äººä¸ºå¤±è¯¯æ—¶ï¼Œå¯ä»¥æŠ›å‡ºå¼‚å¸¸ï¼š
[source, java]
----
builder.useDefaultEL(true);
----
æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½¿ç”¨SpringELè¡¨è¾¾å¼ï¼Œå¯ä»¥é€šè¿‡å‚æ•°æ¥é…ç½®æ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼š
[source, java]
----
builder.useSpringEL(true);
----

==== æ ‡ç­¾æ•°æ®ç±»å‹ä¸åˆæ³•
æˆ‘ä»¬çŸ¥é“æ¸²æŸ“å›¾ç‰‡ã€è¡¨æ ¼ç­‰æ ‡ç­¾æ—¶å¯¹æ•°æ®æ¨¡å‹æ˜¯æœ‰è¦æ±‚çš„ï¼Œå¦‚æœæ•°æ®ä¸åˆæ³•ï¼ˆä¸ºç©ºæˆ–è€…æ˜¯ä¸€ä¸ªé”™è¯¯çš„æ•°æ®ç±»å‹ï¼‰ï¼Œå¯ä»¥é…ç½®æ¨¡æ¿æ ‡ç­¾çš„æ¸²æŸ“è¡Œä¸ºã€‚

poi-tlé»˜è®¤çš„è¡Œä¸ºä¼šæ¸…ç©ºæ ‡ç­¾ï¼Œå¦‚æœå¸Œæœ›å¯¹æ ‡ç­¾ä¸ä½œä»»ä½•å¤„ç†ï¼š
[source, java]
----
builder.setValidErrorHandler(new DiscardHandler());
----

å¦‚æœå¸Œæœ›æ‰§è¡Œä¸¥æ ¼çš„æ ¡éªŒï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼š
[source, java]
----
builder.setValidErrorHandler(new AbortHandler());
----


=== æ¨¡æ¿ç”Ÿæˆæ¨¡æ¿
æ¨¡æ¿å¼•æ“ä¸ä»…ä»…å¯ä»¥ç”Ÿæˆæ–‡æ¡£ï¼Œä¹Ÿå¯ä»¥ç”Ÿæˆæ–°çš„æ¨¡æ¿ï¼Œæ¯”å¦‚æˆ‘ä»¬æŠŠåŸå…ˆçš„ä¸€ä¸ªæ–‡æœ¬æ ‡ç­¾åˆ†æˆä¸€ä¸ªæ–‡æœ¬æ ‡ç­¾å’Œä¸€ä¸ªè¡¨æ ¼æ ‡ç­¾ï¼š

[source, java]
----
Configure config = Configure.builder().bind("title", new DocumentRenderPolicy()).build();

Map<String, Object> data = new HashMap<>();

DocumentRenderData document = Documents.of()
        .addParagraph(Paragraphs.of("{{title}}").create())
        .addParagraph(Paragraphs.of("{{#table}}").create())
        .create();
data.put("title", document);
----

=== æ— æ¨¡æ¿åˆ›å»ºæ–‡æ¡£
ä½¿ç”¨ `XWPFTemplate.create` åœ¨æ— éœ€æ¨¡æ¿çš„æƒ…å†µä¸‹åˆ›å»ºæ–‡æ¡£ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨poi-tlå‹å¥½çš„APIæ¥ç”Ÿæˆæ–‡æ¡£å…ƒç´ ã€‚

[source, java]
----
String text = "this a paragraph";
DocumentRenderData data = Documents.of().addParagraph(Paragraphs.of(text).create()).create();
XWPFTemplate template = XWPFTemplate.create(data);
----

=== æ—¥å¿—
poi-tlä½¿ç”¨slf4jä½œä¸ºæ—¥å¿—é—¨é¢ï¼Œä½ å¯ä»¥è‡ªç”±é€‰æ‹©æ—¥å¿—å®ç°ï¼Œæ¯”å¦‚logbackã€log4jç­‰ã€‚æˆ‘ä»¬ä»¥logbackä¸ºä¾‹ï¼š

é¦–å…ˆåœ¨é¡¹ç›®ä¸­æ·»åŠ logbackä¾èµ–ï¼š
[source, xml]
----
<dependency>
  <groupId>ch.qos.logback</groupId>
  <artifactId>logback-core</artifactId>
  <version>1.2.3</version>
</dependency>
<dependency>
  <groupId>ch.qos.logback</groupId>
  <artifactId>logback-classic</artifactId>
  <version>1.2.3</version>
</dependency>
----

ç„¶åé…ç½®logback.xmlæ–‡ä»¶ï¼Œå¯ä»¥é…ç½®æ—¥å¿—çº§åˆ«å’Œæ ¼å¼ï¼š
[source, xml]
----
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
      <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
    </encoder>
  </appender>

  <logger name="com.deepoove.poi" level="debug" additivity="false">
    <appender-ref ref="STDOUT" />
  </logger>
  <root level="info">
    <appender-ref ref="STDOUT" />
  </root>
</configuration>
----

debugçº§åˆ«çš„æ—¥å¿—ä¼šæ‰“å°è§£ææ¸²æŸ“è¿‡ç¨‹ä¸­çš„ä¿¡æ¯ï¼Œæœ‰åˆ©äºç¨‹åºè°ƒè¯•ï¼Œå¦å¤–åœ¨æ¨¡æ¿å¼•æ“æ‰§è¡Œç»“æŸåä¼šæ‰“å°è€—æ—¶ä¿¡æ¯ï¼š
[example]
--
Successfully Render the template file in 13 millis
--

== æ’ä»¶
æ’ä»¶ï¼Œåˆç§°ä¸º**è‡ªå®šä¹‰å‡½æ•°**ï¼Œå®ƒå…è®¸ç”¨æˆ·åœ¨æ¨¡æ¿æ ‡ç­¾ä½ç½®å¤„æ‰§è¡Œé¢„å…ˆå®šä¹‰å¥½çš„å‡½æ•°ã€‚ç”±äºæ’ä»¶æœºåˆ¶çš„å­˜åœ¨ï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥åœ¨æ¨¡æ¿çš„ä»»ä½•ä½ç½®æ‰§è¡Œä»»ä½•æ“ä½œã€‚

*æ’ä»¶æ˜¯poi-tlçš„æ ¸å¿ƒ*ï¼Œé»˜è®¤çš„æ ‡ç­¾å’Œå¼•ç”¨æ ‡ç­¾éƒ½æ˜¯é€šè¿‡æ’ä»¶åŠ è½½ã€‚

=== é»˜è®¤æ’ä»¶
poi-tlé»˜è®¤æä¾›äº†å…«ä¸ªç­–ç•¥æ’ä»¶ï¼Œç”¨æ¥å¤„ç†æ–‡æœ¬ã€å›¾ç‰‡ã€åˆ—è¡¨ã€è¡¨æ ¼ã€æ–‡æ¡£åµŒå¥—ã€å¼•ç”¨å›¾ç‰‡ã€å¼•ç”¨å¤šç³»åˆ—å›¾è¡¨ã€å¼•ç”¨å•ç³»åˆ—å›¾è¡¨ç­‰ï¼š

* TextRenderPolicy
* PictureRenderPolicy
* NumberingRenderPolicy
* TableRenderPolicy
* DocxRenderPolicy
* MultiSeriesChartTemplateRenderPolicy
* SingleSeriesChartTemplateRenderPolicy
* DefaultPictureTemplateRenderPolicy

ç”±äºè¿™å…«ä¸ªæ’ä»¶å¦‚æ­¤é€šç”¨ï¼Œå› æ­¤å°†è¿™äº›æ’ä»¶æ³¨å†Œä¸ºä¸åŒçš„æ ‡ç­¾ç±»å‹ï¼Œä»è€Œæ­å»ºäº†poi-tlçš„æ ‡ç­¾ä½“ç³»ï¼Œä¹Ÿæ„ç­‘äº†poi-tlé«˜åº¦è‡ªç”±çš„æ’ä»¶æœºåˆ¶ã€‚

[#cus-policy-section]
=== å¼€å‘ä¸€ä¸ªæ’ä»¶
å®ç°ä¸€ä¸ªæ’ä»¶å°±æ˜¯è¦å‘Šè¯‰æˆ‘ä»¬åœ¨æ¨¡æ¿çš„æŸä¸ªåœ°æ–¹ç”¨æŸäº›æ•°æ®åšæŸäº›äº‹æƒ…ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°``RenderPolicy``æ¥å£å¼€å‘è‡ªå·±çš„æ’ä»¶ï¼š
[source, java]
----
public interface RenderPolicy {
  void render(ElementTemplate eleTemplate, Object data, XWPFTemplate template); <1> <2> <3>
}
----
<1> ElementTemplateæ˜¯å½“å‰æ ‡ç­¾ä½ç½®
<2> dataæ˜¯æ•°æ®æ¨¡å‹
<3> XWPFTemplateä»£è¡¨æ•´ä¸ªæ¨¡æ¿

æ¥ä¸‹æ¥æˆ‘ä»¬å†™ä¸€ä¸ªå°†æ ‡ç­¾æ›¿æ¢ä¸ºHello, worldçš„æ’ä»¶ï¼š
[example]
--
[source, java]
----
public class HelloWorldRenderPolicy implements RenderPolicy {

  @Override
  public void render(ElementTemplate eleTemplate, Object data, XWPFTemplate template) {
    XWPFRun run = ((RunTemplate) eleTemplate).getRun(); <1>
    // String thing = String.valueOf(data);
    String thing = "Hello, world";
    run.setText(thing, 0); <2>
  }

}
----
<1> XWPFRunæ˜¯Apache POIçš„ç±»ï¼Œè¡¨ç¤ºå½“å‰ä½ç½®
<2> æ¸²æŸ“æ–‡æœ¬hello, world
--

poi-tlæä¾›äº†æŠ½è±¡æ¨¡æ¿ç±» `AbstractRenderPolicy` ï¼Œå®ƒå®šä¹‰äº†ä¸€äº›éª¨æ¶æ­¥éª¤å¹¶ä¸”å°†æ•°æ®æ¨¡å‹çš„æ ¡éªŒå’Œæ¸²æŸ“é€»è¾‘åˆ†å¼€ï¼Œä½¿ç”¨æ³›å‹çº¦æŸæ•°æ®ç±»å‹ï¼Œè®©æ’ä»¶å¼€å‘èµ·æ¥æ›´ç®€å•ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†å†™ä¸€ä¸ªæ›´å¤æ‚çš„æ’ä»¶ï¼Œåœ¨æ¨¡æ¿æ ‡ç­¾ä½ç½®å®Œå®Œå…¨å…¨ä½¿ç”¨ä»£ç åˆ›å»ºä¸€ä¸ªè¡¨æ ¼ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥éšå¿ƒæ‰€æ¬²çš„æ“ä½œè¡¨æ ¼ï¼š
[example]
--
[source, java]
----
public class CustomTableRenderPolicy extends AbstractRenderPolicy<Object> {

  @Override
  protected void afterRender(RenderContext<Object> context) {
    // æ¸…ç©ºæ ‡ç­¾
    clearPlaceholder(context, true);
  }

  @Override
  public void doRender(RenderContext<Object> context) throws Exception {
    XWPFRun run = context.getRun();
    BodyContainer bodyContainer = BodyContainerFactory.getBodyContainer(run);
    // å®šä¹‰è¡Œåˆ—
    int row = 10, col = 8;
    // æ’å…¥è¡¨æ ¼
    XWPFTable table = bodyContainer.insertNewTable(run, row, col);

    // è¡¨æ ¼å®½åº¦
    TableTools.setWidth(table, UnitUtils.cm2Twips(14.63f) + "", null);
    // è¾¹æ¡†å’Œæ ·å¼
    TableTools.borderTable(table, BorderStyle.DEFAULT);

    // 1) è°ƒç”¨XWPFTable APIæ“ä½œè¡¨æ ¼
    // 2) è°ƒç”¨TableRenderPolicy.Helper.renderRowæ–¹æ³•å¿«é€Ÿæ–¹ä¾¿çš„æ¸²æŸ“ä¸€è¡Œæ•°æ®
    // 3) è°ƒç”¨TableToolsç±»æ–¹æ³•æ“ä½œè¡¨æ ¼ï¼Œæ¯”å¦‚åˆå¹¶å•å…ƒæ ¼
    // ......
    TableTools.mergeCellsHorizonal(table, 0, 0, 7);
    TableTools.mergeCellsVertically(table, 0, 1, 9);
  }

}
----
é€šè¿‡ `bodyContainer.insertNewTable` åœ¨å½“å‰æ ‡ç­¾ä½ç½®æ’å…¥è¡¨æ ¼ï¼Œä½¿ç”¨XWPFTable APIæ¥æ“ä½œè¡¨æ ¼ã€‚
--
NOTE: éšå¿ƒæ‰€æ¬²çš„æ„æ€æ˜¯åŸåˆ™ä¸ŠApache POIæ”¯æŒçš„æ“ä½œï¼Œéƒ½å¯ä»¥åœ¨å½“å‰æ ‡ç­¾ä½ç½®è¿›è¡Œæ¸²æŸ“ï¼ŒApache POIä¸æ”¯æŒçš„æ“ä½œä¹Ÿå¯ä»¥é€šè¿‡ç›´æ¥æ“çºµåº•å±‚XMLæ¥å®ç°ã€‚

=== ä½¿ç”¨æ’ä»¶
æ’ä»¶å¼€å‘å¥½åï¼Œä¸ºäº†è®©æ’ä»¶åœ¨æŸä¸ªæ ‡ç­¾å¤„æ‰§è¡Œï¼Œæˆ‘ä»¬éœ€è¦å°†æ’ä»¶ä¸æ ‡ç­¾ç»‘å®šã€‚

==== å°†æ’ä»¶åº”ç”¨åˆ°æ ‡ç­¾
å½“æˆ‘ä»¬æœ‰ä¸ªæ¨¡æ¿æ ‡ç­¾ä¸º `{{report}}`ï¼Œé»˜è®¤æ˜¯æ–‡æœ¬æ ‡ç­¾ï¼Œå¦‚æœå¸Œæœ›åœ¨è¿™ä¸ªä½ç½®åšäº›ä¸ä¸€æ ·æˆ–è€…æ›´å¤æ‚çš„äº‹æƒ…ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ’ä»¶åº”ç”¨åˆ°è¿™ä¸ªæ¨¡æ¿æ ‡ç­¾ï¼š
[source, java]
ConfigureBuilder builder = Configure.builder();
builder.bind("report", new CustomTableRenderPolicy());

æ­¤æ—¶ï¼Œ`{{report}}` å°†ä¸å†æ˜¯ä¸€ä¸ªæ–‡æœ¬æ ‡ç­¾ï¼Œè€Œæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ ‡ç­¾ã€‚

ConfigureBuilderé‡‡ç”¨äº†é“¾å¼è°ƒç”¨çš„æ–¹å¼ï¼Œå¯ä»¥ä¸€æ¬¡æ€§è®¾ç½®å¤šä¸ªæ ‡ç­¾çš„æ’ä»¶ï¼š
[source, java]
builder.bind("report", new CustomTableRenderPolicy()).bind("name", new MyRenderPolicy());

==== å°†æ’ä»¶æ³¨å†Œä¸ºæ–°æ ‡ç­¾ç±»å‹
å½“å¼€å‘çš„æ’ä»¶å…·æœ‰ä¸€å®šçš„é€šç”¨èƒ½åŠ›å°±å¯ä»¥å°†å…¶æ³¨å†Œä¸ºæ–°çš„æ ‡ç­¾ç±»å‹ã€‚æ¯”å¦‚å¢åŠ %æ ‡è¯†ï¼š`{{%var}}`ï¼Œå¯¹åº”è‡ªå®šä¹‰çš„æ¸²æŸ“ç­–ç•¥ `HelloWorldRenderPolicy`ï¼š
[source, java]
builder.addPlugin('%', new HelloWorldRenderPolicy());

æ­¤æ—¶ï¼Œ`{{%var}}` å°†æˆä¸ºä¸€ç§æ–°çš„æ ‡ç­¾ç±»å‹ï¼Œå®ƒçš„æ‰§è¡Œå‡½æ•°æ˜¯ `HelloWorldRenderPolicy`ã€‚

=== Plugin Example
æ¥ä¸‹æ¥ç”¨ä¸€ä¸ªå®Œæ•´çš„ä»£ç ç¤ºä¾‹å‘ä½ å±•ç¤º _Do Anything Anywhere_ çš„æƒ³æ³•ï¼Œå®ƒä¸ä½¿ç”¨ä»»ä½•poi-tlçš„é»˜è®¤æ’ä»¶ï¼Œå®Œå…¨ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°å®Œæˆã€‚

æ’ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„å…¥å‚æ˜¯anywhereå’Œanythingï¼Œå‡½æ•°ä½“å°±æ˜¯do somethingã€‚

[example]
--
[source, java]
----
// whereç»‘å®špolicy
Configure config = Configure.builder().bind("sea", new AbstractRenderPolicy<String>() {
  @Override
  public void doRender(RenderContext<String> context) throws Exception { <1>
      // anywhere
      XWPFRun where = context.getWhere();
      // anything
      String thing = context.getThing();
      // do æ–‡æœ¬
      where.setText(thing, 0);
  }
}).bind("sea_img", new AbstractRenderPolicy<String>() {
  @Override
  public void doRender(RenderContext<String> context) throws Exception { <2>
      // anywhere delegate
      WhereDelegate where = context.getWhereDelegate();
      // any thing
      String thing = context.getThing();
      // do å›¾ç‰‡
      FileInputStream stream = null;
      try {
          stream = new FileInputStream(thing);
          where.addPicture(stream, XWPFDocument.PICTURE_TYPE_JPEG, 400, 450);
      } finally {
          IOUtils.closeQuietly(stream);
      }
      // clear
      clearPlaceholder(context, false);
  }
}).bind("sea_feature", new AbstractRenderPolicy<List<String>>() {
  @Override
  public void doRender(RenderContext<List<String>> context) throws Exception { <3>
      // anywhere delegate
      WhereDelegate where = context.getWhereDelegate();
      // anything
      List<String> thing = context.getThing();
      // do åˆ—è¡¨
      where.renderNumbering(Numberings.of(thing.toArray(new String[] {})).create());
      // clear
      clearPlaceholder(context, true);
  }
}).build();

// åˆå§‹åŒ–whereçš„æ•°æ®
HashMap<String, Object> args = new HashMap<String, Object>();
args.put("sea", "Hello, world!");
args.put("sea_img", "sea.jpg");
args.put("sea_feature", Arrays.asList("é¢æœå¤§æµ·æ˜¥æš–èŠ±å¼€", "ä»Šæœæœ‰é…’ä»Šæœé†‰"));
args.put("sea_location", Arrays.asList("æ—¥è½ï¼šæ—¥è½å±±èŠ±çº¢å››æµ·", "èŠ±æµ·ï¼šä½ æƒ³è¦çš„éƒ½åœ¨è¿™é‡Œ"));

// ä¸€è¡Œä»£ç 
XWPFTemplate.compile("sea.docx", config).render(args).writeToFile("out_sea.docx");

----
<1> è‡ªå®šä¹‰æ–‡æœ¬æ’ä»¶
<2> è‡ªå®šä¹‰å›¾ç‰‡æ’ä»¶
<3> è‡ªå®šä¹‰åˆ—è¡¨æ’ä»¶
--

== å¯é€‰æ’ä»¶

[#plugin-list]
=== æ’ä»¶åˆ—è¡¨
é™¤äº†å…«ä¸ªé€šç”¨çš„ç­–ç•¥æ’ä»¶å¤–ï¼Œè¿˜å†…ç½®äº†ä¸€äº›éå¸¸æœ‰ç”¨çš„æ’ä»¶ã€‚
|===
| `ParagraphRenderPolicy` |æ¸²æŸ“ä¸€ä¸ªæ®µè½ï¼Œå¯ä»¥åŒ…å«ä¸åŒæ ·å¼æ–‡æœ¬ï¼Œå›¾ç‰‡ç­‰ |
| `DocumentRenderPolicy` |æ¸²æŸ“æ•´ä¸ªwordæ–‡æ¡£ |
| `CommentRenderPolicy` |å®Œæ•´çš„æ‰¹æ³¨åŠŸèƒ½ | link:#plugin-comment[ç¤ºä¾‹-æ‰¹æ³¨]
| `AttachmentRenderPolicy` |æ’å…¥é™„ä»¶åŠŸèƒ½ | link:#plugin-attachment[ç¤ºä¾‹-æ’å…¥é™„ä»¶]
| `LoopRowTableRenderPolicy` |å¾ªç¯è¡¨æ ¼è¡Œï¼Œä¸‹æ–‡ä¼šè¯¦ç»†ä»‹ç» | link:#hack-loop-table[ç¤ºä¾‹-è¡¨æ ¼è¡Œå¾ªç¯]
| `LoopColumnTableRenderPolicy` |å¾ªç¯è¡¨æ ¼åˆ— |link:#loop-col-table[ç¤ºä¾‹-è¡¨æ ¼åˆ—å¾ªç¯]
| `DynamicTableRenderPolicy` |åŠ¨æ€è¡¨æ ¼æ’ä»¶ï¼Œå…è®¸ç›´æ¥æ“ä½œè¡¨æ ¼å¯¹è±¡ |link:#plugin-dynamic-table[ç¤ºä¾‹-åŠ¨æ€è¡¨æ ¼]
| `BookmarkRenderPolicy` |ä¹¦ç­¾å’Œé”šç‚¹ |link:#example-swagger[ç¤ºä¾‹-Swaggeræ–‡æ¡£]
| `AbstractChartTemplateRenderPolicy` | å¼•ç”¨å›¾è¡¨æ’ä»¶ï¼Œå…è®¸ç›´æ¥æ“ä½œå›¾è¡¨å¯¹è±¡ |
| `TOCRenderPolicy` |Betaå®éªŒåŠŸèƒ½ï¼šç›®å½•ï¼Œæ‰“å¼€æ–‡æ¡£æ—¶ä¼šæç¤ºæ›´æ–°åŸŸ |
|===

åŒæ—¶æœ‰æ›´å¤šçš„ç‹¬ç«‹æ’ä»¶å¯ä»¥ä½¿ç”¨ï¼ˆéœ€è¦å¼•å…¥å¯¹åº”Mavenä¾èµ–ï¼‰ï¼š
|===
| `HighlightRenderPolicy` |Wordæ”¯æŒä»£ç é«˜äº® | link:#plugin-highlight[ç¤ºä¾‹-ä»£ç é«˜äº®]
| `MarkdownRenderPolicy` |ä½¿ç”¨Markdownæ¥æ¸²æŸ“word | link:#plugin-markdown[ç¤ºä¾‹-Markdown]
|===

NOTE: å¦‚æœä½ å†™äº†ä¸€ä¸ªä¸é”™çš„æ’ä»¶ï¼Œæ¬¢è¿åˆ†äº«ã€‚

[#hack-loop-table]
=== è¡¨æ ¼è¡Œå¾ªç¯
`LoopRowTableRenderPolicy` æ˜¯ä¸€ä¸ªç‰¹å®šåœºæ™¯çš„æ’ä»¶ï¼Œæ ¹æ®é›†åˆæ•°æ®å¾ªç¯è¡¨æ ¼è¡Œã€‚

[example]
--
.template.docx
è´§ç‰©æ˜ç»†å’Œäººå·¥è´¹åœ¨åŒä¸€ä¸ªè¡¨æ ¼ä¸­ï¼Œè´§ç‰©æ˜ç»†éœ€è¦å±•ç¤ºæ‰€æœ‰è´§ç‰©ï¼Œäººå·¥è´¹éœ€è¦å±•ç¤ºæ‰€æœ‰è´¹ç”¨ã€‚`{{goods}}` æ˜¯ä¸ªæ ‡å‡†çš„æ ‡ç­¾ï¼Œå°† `{{goods}}` **ç½®äºå¾ªç¯è¡Œçš„ä¸Šä¸€è¡Œ**ï¼Œå¾ªç¯è¡Œè®¾ç½®è¦å¾ªç¯çš„æ ‡ç­¾å’Œå†…å®¹ï¼Œæ³¨æ„æ­¤æ—¶çš„æ ‡ç­¾åº”è¯¥ä½¿ç”¨ `[]` ï¼Œä»¥æ­¤æ¥åŒºåˆ«poi-tlçš„é»˜è®¤æ ‡ç­¾è¯­æ³•ã€‚åŒç†ï¼Œ`{{labors}}` ä¹Ÿ**ç½®äºå¾ªç¯è¡Œçš„ä¸Šä¸€è¡Œ**ã€‚

image::./example/example_looptable_template.png[width=650, align='center']
--

[example]
--
.ä»£ç ç¤ºä¾‹
`{{goods}}` å’Œ `{{labors}}` æ ‡ç­¾å¯¹åº”çš„æ•°æ®åˆ†åˆ«æ˜¯è´§ç‰©é›†åˆå’Œäººå·¥è´¹é›†åˆï¼Œå¦‚æœé›†åˆä¸ºç©ºåˆ™ä¼šåˆ é™¤å¾ªç¯è¡Œã€‚
[source, java]
----
class Goods {
  private int count;
  private String name;
  private String desc;
  private int discount;
  private int tax;
  private int price;
  private int totalPrice;
  // getter setter
}

class Labor {
  private String category;
  private int people;
  private int price;
  private int totalPrice;
  // getter setter
}

List<Goods> goods = new ArrayList<>();
List<Labor> labors = new ArrayList<>();
----

æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ’ä»¶åº”ç”¨åˆ°è¿™ä¸¤ä¸ªæ ‡ç­¾ã€‚
[source, java]
----
LoopRowTableRenderPolicy policy = new LoopRowTableRenderPolicy();

Configure config = Configure.builder()
        .bind("goods", policy).bind("labors", policy).build(); <1>

XWPFTemplate template = XWPFTemplate.compile(resource, config).render(
  new HashMap<String, Object>() {{
      put("goods", goods);
      put("labors", labors);
    }}
);
----
<1> ç»‘å®šæ’ä»¶
--

[example]
--
.output.docx
æœ€ç»ˆç”Ÿæˆçš„æ–‡æ¡£åˆ—å‡ºäº†æ‰€æœ‰è´§ç‰©å’Œäººå·¥è´¹ã€‚

image::./example/example_looptable_output.png[width=650, align='center']
--

NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/plugin/HackLoopTableRenderPolicyTest.java[JUnit LoopRowTableRenderPolicyTest]ï¼Œå¦‚æœå¸Œæœ›æ¨¡æ¿æ ‡ç­¾å’Œå¾ªç¯è¡Œåœ¨åŒä¸€è¡Œè€Œä¸æ˜¯åœ¨ä¸Šä¸€è¡Œï¼Œå¯ä»¥ä½¿ç”¨ `new LoopRowTableRenderPolicy(true)` æ¥æ„é€ æ’ä»¶ã€‚

[#loop-col-table]
=== è¡¨æ ¼åˆ—å¾ªç¯
`LoopColumnTableRenderPolicy` æ˜¯ä¸€ä¸ªç‰¹å®šåœºæ™¯çš„æ’ä»¶ï¼Œæ ¹æ®é›†åˆæ•°æ®å¾ªç¯è¡¨æ ¼åˆ—ã€‚**è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæ–‡æ¡£å®½åº¦æœ‰é™ï¼Œå› æ­¤æ¨¡æ¿åˆ—å¿…é¡»è®¾ç½®å®½åº¦ï¼Œæ‰€æœ‰å¾ªç¯åˆ—å°†å¹³åˆ†æ¨¡æ¿åˆ—çš„å®½åº¦ã€‚**

[example]
--
.template.docx
`LoopColumnTableRenderPolicy` å¾ªç¯åˆ—çš„ä½¿ç”¨æ–¹å¼å’Œæ’ä»¶ `LoopRowTableRenderPolicy` æ˜¯ä¸€æ ·çš„ï¼Œéœ€è¦å°†å ä½æ ‡ç­¾æ”¾åœ¨å¾ªç¯åˆ—çš„å‰ä¸€åˆ—ã€‚

image::./example/example_loopcol_template.png[width=650, align='center']
--

[example]
--
.ä»£ç ç¤ºä¾‹
[source, java]
----
LoopColumnTableRenderPolicy policy = new LoopColumnTableRenderPolicy();

Configure config = Configure.builder().bind("goods", policy).build();

XWPFTemplate template = XWPFTemplate.compile(resource, config).render(
  new HashMap<String, Object>() {{
      put("goods", goods);
    }}
);
----
--

[example]
--
.output.docx
æœ€ç»ˆç”Ÿæˆçš„æ–‡æ¡£åˆ—å‡ºäº†æ‰€æœ‰è´§ç‰©å’Œäººå·¥è´¹ã€‚

image::./example/example_loopcol_output.png[width=650, align='center']
--

NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/plugin/LoopColumnTableRenderPolicyTest.java[JUnit LoopColumnTableRenderPolicyTest]

[#plugin-dynamic-table]
=== åŠ¨æ€è¡¨æ ¼
å½“éœ€æ±‚ä¸­çš„è¡¨æ ¼æ›´åŠ å¤æ‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥è®¾è®¡å¥½é‚£äº›å›ºå®šçš„éƒ¨åˆ†ï¼Œå°†éœ€è¦åŠ¨æ€æ¸²æŸ“çš„éƒ¨åˆ†å•å…ƒæ ¼äº¤ç»™è‡ªå®šä¹‰æ¨¡æ¿æ¸²æŸ“ç­–ç•¥ã€‚poi-tlæä¾›äº†æŠ½è±¡è¡¨æ ¼ç­–ç•¥ `DynamicTableRenderPolicy` æ¥å®ç°è¿™æ ·çš„åŠŸèƒ½ã€‚
[source, java]
----
public abstract class DynamicTableRenderPolicy implements RenderPolicy {
  public abstract void render(XWPFTable table, Object data);
}
----

[example]
--
.template.docx
{{detail_table}}æ ‡ç­¾å¯ä»¥åœ¨è¡¨æ ¼å†…çš„ä»»æ„å•å…ƒæ ¼å†…ï¼ŒDynamicTableRenderPolicyä¼šè·å–XWPFTableå¯¹è±¡è¿›è€Œè·å¾—æ“ä½œæ•´ä¸ªè¡¨æ ¼çš„èƒ½åŠ›ã€‚


image::./example/dynamic.png[width=650, align='center']
--

[example]
--
.ä»£ç ç¤ºä¾‹
é¦–å…ˆæ–°å»ºæ¸²æŸ“ç­–ç•¥DetailTablePolicyï¼Œç»§æ‰¿äºæŠ½è±¡è¡¨æ ¼ç­–ç•¥ã€‚
[source, java]
----
public class DetailTablePolicy extends DynamicTableRenderPolicy {

  // è´§å“å¡«å……æ•°æ®æ‰€åœ¨è¡Œæ•°
  int goodsStartRow = 2;
  // äººå·¥è´¹å¡«å……æ•°æ®æ‰€åœ¨è¡Œæ•°
  int laborsStartRow = 5;

  @Override
  public void render(XWPFTable table, Object data) throws Exception {
    if (null == data) return;
    DetailData detailData = (DetailData) data;

    // äººå·¥è´¹
    List<RowRenderData> labors = detailData.getLabors();
    if (null != labors) {
      table.removeRow(laborsStartRow);
      // å¾ªç¯æ’å…¥è¡Œ
      for (int i = 0; i < labors.size(); i++) {
        XWPFTableRow insertNewTableRow = table.insertNewTableRow(laborsStartRow);
        for (int j = 0; j < 7; j++) insertNewTableRow.createCell();

        // åˆå¹¶å•å…ƒæ ¼
        TableTools.mergeCellsHorizonal(table, laborsStartRow, 0, 3);
        // å•è¡Œæ¸²æŸ“
        TableRenderPolicy.Helper.renderRow(table.getRow(laborsStartRow), labors.get(i));
      }
    }

    // è´§ç‰©
    List<RowRenderData> goods = detailData.getGoods();
    if (null != goods) {
      table.removeRow(goodsStartRow);
      for (int i = 0; i < goods.size(); i++) {
        XWPFTableRow insertNewTableRow = table.insertNewTableRow(goodsStartRow);
        for (int j = 0; j < 7; j++) insertNewTableRow.createCell();
        TableRenderPolicy.Helper.renderRow(table.getRow(goodsStartRow), goods.get(i));
      }
    }
  }
}
----

ç„¶åå°†æ¨¡æ¿æ ‡ç­¾{{detail_table}}è®¾ç½®æˆæ­¤ç­–ç•¥ã€‚
[source, java]
----
Configure config = Configure.builder().bind("detail_table", new DetailTablePolicy()).build();
----
--

[example]
--
.output.docx
æœ€ç»ˆç”Ÿæˆçš„æ–‡æ¡£åˆ—å‡ºäº†æ‰€æœ‰è´§ç‰©å’Œäººå·¥è´¹ã€‚

image::./example/dynamic_output.png[width=650, align='center']
--

NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/example/PaymentExample.java[JUnit PaymentExample]

[#plugin-comment]
=== æ‰¹æ³¨
`CommentRenderPolicy` æ˜¯å†…ç½®æ’ä»¶ï¼Œæä¾›äº†å¯¹æ‰¹æ³¨å®Œæ•´åŠŸèƒ½çš„æ”¯æŒã€‚

æ•°æ®æ¨¡å‹ï¼š

- `CommentRenderData`

[sidebar]
.ä»£ç ç¤ºä¾‹
--
[source, java]
----
CommentRenderData comment = Comments.of("é¹…")
                .signature("Sayi", "s", LocaleUtil.getLocaleCalendar())
                .comment("é¹…ï¼Œæ˜¯ä¸€ç§åŠ¨ç‰©")
                .create(); <1>
Map<String, Object> data = new HashMap<>();
data.put("comment", comment);
Configure config = Configure.builder().bind("comment", new CommentRenderPolicy()).build(); <2>

XWPFTemplate.compile("comment_template.docx", config).render(data);
----
<1> æ‰¹æ³¨å†…å®¹
<2> å°†æ‰¹æ³¨æ’ä»¶å’Œcommentæ ‡ç­¾ç»‘å®š
--

==== ç¤ºä¾‹
[example]
--
.output.docx
æ‰¹æ³¨ä¸­æ”¯æŒæ·»åŠ æ–‡å­—ã€å›¾ç‰‡ç­‰æ–‡æ¡£å†…å®¹ã€‚

image::./example/example_comment_output.png[align='center']
--
NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/plugin/CommentRenderPolicyTest.java[JUnit CommentRenderPolicyTest]ã€‚

[#plugin-attachment]
=== æ’å…¥é™„ä»¶
`AttachmentRenderPolicy` æ˜¯å†…ç½®æ’ä»¶ï¼Œæä¾›äº†æ’å…¥é™„ä»¶åŠŸèƒ½çš„æ”¯æŒã€‚

æ•°æ®æ¨¡å‹ï¼š

- `AttachmentRenderData`

[sidebar]
.ä»£ç ç¤ºä¾‹
--
[source, java]
----
AttachmentRenderData attach = Attachments.ofLocal("attachment.xlsx", AttachmentType.XLSX).create(); <1>

Map<String, Object> data = new HashMap<>();
data.put("attachment", attach);
Configure config = Configure.builder().bind("attachment", new AttachmentRenderPolicy()).build(); <2>

XWPFTemplate.compile("attachment_template.docx", config).render(data);
----
<1> é™„ä»¶æ–‡æ¡£ï¼ŒWordæˆ–è€…Excel
<2> ç»‘å®šæ ‡ç­¾å’Œé™„ä»¶æ’ä»¶
--

==== ç¤ºä¾‹
[example]
--
.output.docx
æ–‡æ¡£ä¸­æ’å…¥Excelï¼ŒåŒå‡»å›¾æ ‡æ‰“å¼€é™„ä»¶ã€‚

image::./example/example_attach_output.png[align='center']
--
NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/policy/AttachmentRenderTest.java[JUnit AttachmentRenderPolicyTest]ã€‚

[#plugin-highlight]
=== ä»£ç é«˜äº®
`HighlightRenderPolicy` æ’ä»¶å¯¹Wordä»£ç å—è¿›è¡Œé«˜äº®å±•ç¤ºã€‚

==== å¼•å…¥ä¾èµ–ï¼š
[source, xml]
----
<dependency>
  <groupId>com.deepoove</groupId>
  <artifactId>poi-tl-plugin-highlight</artifactId>
  <version>1.0.0</version>
</dependency>
----

==== å¿«é€Ÿå¼€å§‹

æ•°æ®æ¨¡å‹ï¼š

- `HighlightRenderData`

[sidebar]
.ä»£ç ç¤ºä¾‹
--
[source, java]
----
HighlightRenderData code = new HighlightRenderData();
code.setCode("/**\n"
        + " * @author John Smith <john.smith@example.com>\n"
        + "*/\n"
        + "package l2f.gameserver.model;\n"
        + "\n"
        + "public abstract strictfp class L2Char extends L2Object {\n"
        + "  public static final Short ERROR = 0x0001;\n"
        + "\n"
        + "  public void moveTo(int x, int y, int z) {\n"
        + "    _ai = null;\n"
        + "    log(\"Should not be called\");\n"
        + "    if (1 > 5) { // wtf!?\n"
        + "      return;\n"
        + "    }\n"
        + "  }\n"
        + "}");
code.setLanguage("java"); <1>
code.setStyle(HighlightStyle.builder().withShowLine(true).withTheme("zenburn").build()); <2>
Map<String, Object> data = new HashMap<>();
data.put("code", code);

Configure config = Configure.builder().bind("code", new HighlightRenderPolicy()).build(); <3>
XWPFTemplate.compile("highlight_template.docx", config).render(data);
----
<1> ä»£ç è¯­è¨€
<2> è®¾ç½®ä¸»é¢˜æ ·å¼
<3> å°†ä»£ç é«˜äº®æ’ä»¶å’Œcodeæ ‡ç­¾ç»‘å®š
--

==== ç¤ºä¾‹
[example]
--
.output.docx
ç¤ºä¾‹å±•ç¤ºäº†ä»£ç é«˜äº®æ’ä»¶æ”¯æŒ20å¤šç§ç¼–ç¨‹è¯­è¨€å’Œå‡ åç§ä¸»é¢˜æ ·å¼ã€‚

image::./example/highlight.png[align='center']
--
NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl-plugin-highlight/src/test/java/com/deepoove/poi/plugin/highlight/HighlightRenderPolicyTest.java[JUnit HighlightRenderPolicyTest]ã€‚

==== å¸¸ç”¨è¯­è¨€æ”¯æŒ
- apache
- bash
- cpp
- cs
- css
- diff
- go
- groovy
- http
- ini
- java
- javascript
- json
- makefile
- markdown
- objectivec
- perl
- php
- python
- ruby
- scala
- shell
- sql
- xml
- yaml

==== å¸¸ç”¨ä¸»é¢˜æ ·å¼
- github
- idea
- zenburn
- androidstudio
- solarized- light
- solarized- dark
- xcode
- vs
- agate
- darcula
- dark
- dracula
- foundation
- googlecode
- monokai
- mono- blue
- far
- gml

[#plugin-markdown]
=== Markdown
`MarkdownRenderPolicy` æ’ä»¶æ”¯æŒé€šè¿‡Markdownç”Ÿæˆwordæ–‡æ¡£ã€‚

==== å¼•å…¥ä¾èµ–ï¼š
[source, xml]
----
<dependency>
  <groupId>com.deepoove</groupId>
  <artifactId>poi-tl-plugin-markdown</artifactId>
  <version>1.0.3</version>
</dependency>
----

==== å¿«é€Ÿå¼€å§‹

æ•°æ®æ¨¡å‹ï¼š

- `MarkdownRenderData`

[sidebar]
.ä»£ç ç¤ºä¾‹
--
[source, java]
----
MarkdownRenderData code = new MarkdownRenderData();
code.setMarkdown(new String(Files.readAllBytes(Paths.get("README.md"))));
code.setStyle(MarkdownStyle.newStyle()); <1>

Map<String, Object> data = new HashMap<>();
data.put("md", code);

Configure config = Configure.builder().bind("md", new MarkdownRenderPolicy()).build(); <2>
XWPFTemplate.compile("markdown_template.docx", config).render(data);
----
<1> å®šåˆ¶markdownè½¬ä¸ºwordçš„æ ·å¼
<2> å°†Markdownæ’ä»¶å’Œmdæ ‡ç­¾ç»‘å®š
--

==== ç¤ºä¾‹
[example]
--
.output.docx
é€šè¿‡Markdownæ’ä»¶å°†poi-tlæ ¹ç›®å½•ä¸‹çš„README.mdå†…å®¹è½¬ä¸ºwordæ–‡æ¡£çš„ç»“æœç¤ºä¾‹ï¼šlink:./example/example_markdown_output.docx[markdown.docx]

image::./example/example_markdown_output.png[align='center']
--


NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl-plugin-markdown/src/test/java/com/deepoove/poi/plugin/markdown/MarkdownRenderPolicyTest.java[JUnit MarkdownRenderPolicyTest]ã€‚

== ç¤ºä¾‹
æ¥ä¸‹æ¥çš„ç¤ºä¾‹é‡‡å–ä¸‰æ®µå¼output+template+data-modelæ¥è¯´æ˜ï¼Œé¦–å…ˆç›´æ¥å±•ç¤ºç”Ÿæˆåçš„æ–‡æ¡£ï¼Œç„¶åä¸€è§ˆæ¨¡æ¿çš„æ ·å­ï¼Œæœ€åæˆ‘ä»¬å¯¹æ•°æ®æ¨¡å‹ä½œä¸ªä»‹ç»ã€‚

=== è½¯ä»¶è¯´æ˜æ–‡æ¡£
[example]
--
.output.docx
éœ€è¦ç”Ÿæˆè¿™æ ·çš„ä¸€ä»½è½¯ä»¶è¯´æ˜ä¹¦ï¼šæ‹¥æœ‰å°é¢å’Œé¡µçœ‰ï¼Œæ­£æ–‡å«æœ‰ä¸åŒæ ·å¼çš„æ–‡æœ¬ï¼Œè¿˜æœ‰è¡¨æ ¼ï¼Œåˆ—è¡¨å’Œå›¾ç‰‡ã€‚link:./example/poi-tl.docx[poi_tl.docx]

image::./example/example_poitl_output1.png[align='center']
--

[example]
--
.template.docx
ä½¿ç”¨poi-tlæ ‡ç­¾åˆ¶ä½œæ¨¡æ¿ï¼Œå¯ä»¥çœ‹åˆ°æ ‡ç­¾å¯ä»¥æ‹¥æœ‰æ ·å¼ã€‚

image::./example/example_poitl_template1.png[align='center']
--

è¿™ä¸ªç¤ºä¾‹å‘æˆ‘ä»¬å±•ç¤ºäº†poi-tlæœ€åŸºæœ¬çš„èƒ½åŠ›ï¼Œå®ƒåœ¨æ¨¡æ¿æ ‡ç­¾ä½ç½®ï¼Œæ’å…¥åŸºæœ¬çš„æ•°æ®æ¨¡å‹ï¼Œæ‰€è§å³æ‰€å¾—ã€‚

NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/XWPFTemplateTest.java[JUnit XWPFTemplateTest]

[#example-table]
=== ä»˜æ¬¾é€šçŸ¥ä¹¦
[example]
--
.output.docx
éœ€è¦ç”Ÿæˆè¿™æ ·çš„ä¸€ä»½æµè¡Œçš„é€šçŸ¥ä¹¦ï¼šå¤§éƒ¨åˆ†æ•°æ®æ˜¯ç”±è¡¨æ ¼æ„æˆçš„ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªè®¢å•çš„è¡¨æ ¼(å›¾ä¸­ç¬¬ä¸€ä¸ªè¡¨æ ¼)ï¼Œè¿˜éœ€è¦åœ¨ä¸€ä¸ªå·²æœ‰è¡¨æ ¼ä¸­ï¼Œå¡«å……è´§ç‰©æ˜ç»†å’Œäººå·¥è´¹æ•°æ®(å›¾ä¸­ç¬¬äºŒä¸ªè¡¨æ ¼)ã€‚ä¸‹è½½æœ€ç»ˆç”Ÿæˆçš„æ–‡ä»¶link:./example/payment.docx[payment.docx]

image::./example/example_payment_output.png[align='center']
--

[example]
--
.template.docx
ä½¿ç”¨{{#order}}ç”Ÿæˆpoi-tlæä¾›çš„é»˜è®¤æ ·å¼çš„è¡¨æ ¼ï¼Œè®¾ç½®{{detail_table}}ä¸ºè‡ªå®šä¹‰æ¨¡æ¿æ¸²æŸ“ç­–ç•¥(ç»§æ‰¿æŠ½è±¡è¡¨æ ¼ç­–ç•¥DynamicTableRenderPolicy)ï¼Œè‡ªå®šä¹‰å·²æœ‰è¡¨æ ¼ä¸­éƒ¨åˆ†å•å…ƒæ ¼çš„æ¸²æŸ“ã€‚

image::./example/example_payment_template.png[align='center']
--

è¿™ä¸ªç¤ºä¾‹å‘æˆ‘ä»¬å±•ç¤ºäº†poi-tlåœ¨è¡¨æ ¼æ“ä½œä¸Šçš„ä¸€äº›æ€è€ƒã€‚ç¤ºä¾‹ä¸­è´§ç‰©æ˜ç»†å’Œäººå·¥è´¹çš„è¡¨æ ¼å°±æ˜¯ä¸€ä¸ªç›¸å½“å¤æ‚çš„è¡¨æ ¼ï¼Œè´§ç‰©æ˜ç»†æ˜¯ç”±7åˆ—ç»„æˆï¼Œè¡Œæ•°ä¸å®šï¼Œäººå·¥è´¹æ˜¯ç”±4åˆ—ç»„æˆï¼Œè¡Œæ•°ä¸å®šã€‚

è¿™ä¸ªç¤ºä¾‹ä¸»è¦ç”¨æ¥å±•ç¤ºlink:#plugin-dynamic-table[DynamicTableRenderPolicy]çš„ç”¨æ³•ï¼Œè´§ç‰©æ˜ç»†å’Œäººå·¥è´¹ä»…ä»…æ˜¯å¾ªç¯æ¸²æŸ“è¡¨æ ¼è¡Œï¼Œä½¿ç”¨link:#hack-loop-table[LoopRowTableRenderPolicy] æ’ä»¶ä¼šæ›´æ–¹ä¾¿ã€‚

NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/example/PaymentExample.java[JUnit PaymentExample]

[#example-okr]
=== ç›®æ ‡åˆ¶å®š
[example]
--
.output.docx
éœ€è¦åˆ¶å®šä¸€ä»½OKRç›®æ ‡è®¡åˆ’ï¼Œä¸šåŠ¡ç›®æ ‡å’Œç®¡ç†ç›®æ ‡ä½¿ç”¨è¡¨æ ¼å‘ˆç°ï¼Œæ•°é‡ä¸ç­‰ã€‚ä¸‹è½½æœ€ç»ˆç”Ÿæˆçš„æ–‡ä»¶link:./example/okr.docx[okr.docx]

image::./example/example_okr_output.png[align='center']
--

[example]
--
.template.docx
å°†è¡¨æ ¼æ”¾åˆ°åŒºå—å¯¹ä¸­ï¼Œå½“åŒºå—å¯¹å–å€¼ä¸ºç©ºé›†åˆæˆ–è€…nullåˆ™ä¸ä¼šå±•ç¤ºç›®æ ‡è¡¨æ ¼ï¼Œå½“åŒºå—å¯¹æ˜¯ä¸€ä¸ªéç©ºé›†åˆåˆ™å¾ªç¯å±•ç¤ºè¡¨æ ¼ã€‚

image::./example/example_okr_template.png[align='center']
--

è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†åŒºå—å¯¹çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥å¯¹æ–‡æ¡£å†…å®¹è¿›è¡Œå¾ªç¯æ¸²æŸ“ã€‚

NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/example/OKRExample.java[JUnit OKRExample]

[#example-animal]
=== é‡ç”ŸåŠ¨ç‰©ç°çŠ¶
[example]
--
.output.docx
é’ˆå¯¹é‡ç”ŸåŠ¨ç‰©å‡ºå…·ä¸€ä»½ç°çŠ¶çš„è°ƒæŸ¥æŠ¥å‘Šï¼Œé‡ç”ŸåŠ¨ç‰©ç§ç±»ä¸ç¡®å®šï¼Œè°ƒæŸ¥æŠ¥å‘ŠåŒ…å«å›¾ç‰‡ã€æ–‡å­—å’Œå›¾è¡¨ã€‚ä¸‹è½½æœ€ç»ˆç”Ÿæˆçš„æ–‡ä»¶link:./example/animal.docx[animal.docx]

image::./example/example_animal_output.png[align='center']
--

[example]
--
.template.docx
ä¸ç¡®å®šåŠ¨ç‰©ç§ç±»ä½¿ç”¨åŒºå—å¯¹{{?animals}}çš„å¾ªç¯åŠŸèƒ½å®ç°ï¼Œå›¾ç‰‡å’Œå›¾è¡¨å¦‚æ¨¡æ¿æ‰€ç¤ºï¼Œä½¿ç”¨å¼•ç”¨æ ‡ç­¾ï¼Œåœ¨å¯é€‰æ–‡å­—æ ‡é¢˜ä½ç½®è¾“å…¥æ ‡ç­¾ã€‚

image::./example/example_animal_template.png[align='center']
--

è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†åŒºå—å¯¹çš„å¾ªç¯åŠŸèƒ½ï¼Œä»¥åŠå¦‚ä½•åœ¨å¾ªç¯ä¸­ä½¿ç”¨å¼•ç”¨å›¾ç‰‡å’Œå¼•ç”¨å›¾è¡¨çš„åŠŸèƒ½ã€‚

NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/example/AnimalExample.java[JUnit AnimalExample]

[#example-certificate]
=== è¯ä¹¦å¥–çŠ¶
[example]
--
.output.docx
é¢å‘ä¸€å¼ ç”±ç‰¹æ®Šæ ·å¼å›¾ç‰‡ã€å§“åã€æ—¥æœŸæ„æˆçš„è¯ä¹¦å¥–çŠ¶ã€‚ä¸‹è½½æœ€ç»ˆç”Ÿæˆçš„æ–‡ä»¶link:./example/certificate.docx[certificate.docx]

image::./example/example_certificate_output.png[align='center']
--

[example]
--
.template.docx
å›¾ç‰‡æ ¼å¼å’Œå¸ƒå±€ç”±æ¨¡æ¿æŒ‡å®šï¼Œå›¾ç‰‡ä½¿ç”¨å¼•ç”¨æ ‡ç­¾æ›¿æ¢å³å¯ã€‚

image::./example/example_certificate_template.png[align='center']
--

è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¼•ç”¨å›¾ç‰‡å’Œæ–‡æœ¬æ¡†çš„åŠŸèƒ½ã€‚

NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/example/CertificateExample.java[JUnit CertificateExample]

[#example-resume]
=== ä¸ªäººç®€å†
[example]
--
.output.docx
éœ€è¦ç”Ÿæˆè¿™æ ·çš„ä¸€ä»½ä¸ªäººç®€å†ï¼šå·¦ä¾§æ˜¯ä¸ªäººçš„åŸºæœ¬ä¿¡æ¯ï¼ŒæŠ€æœ¯æ ˆæ˜¯ä¸ªå…¸å‹çš„åˆ—è¡¨ï¼Œå³ä¾§æ˜¯ä¸ªäººçš„å·¥ä½œç»å†ï¼Œæ•°é‡ä¸å®šã€‚ä¸‹è½½æœ€ç»ˆç”Ÿæˆçš„æ–‡ä»¶link:./example/resume.docx[resume.docx]

image::./example/example_resume_output.png[align='center']
--

==== æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨åŒºå—å¯¹æ ‡ç­¾
[example]
--
.template.docx
å·¥ä½œç»å†æ˜¯ä¸€ä¸ªå¾ªç¯æ˜¾ç¤ºçš„å†…å®¹ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒºå—å¯¹æ ‡ç­¾{{?experiences}}{{/experiences}}ã€‚

image::./example/example_iterable_resume_template.png[align='center']
--

NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/render/IterableRenderResumeExample.java[JUnit Iterable ResumeExample]

==== æ–¹æ¡ˆäºŒï¼šä½¿ç”¨åµŒå¥—æ ‡ç­¾
[example]
--
.template.docx
å·¥ä½œç»å†å¯ä»¥ä½¿ç”¨åµŒå¥—æ ‡ç­¾ï¼Œæˆ‘ä»¬åˆ¶ä½œä¸¤ä¸ªæ¨¡æ¿ï¼Œä¸€å¥—ä¸»æ¨¡æ¿ç®€å†.docx(ä¸‹å›¾å·¦ä¾§)ï¼Œä¸€å¥—ä¸ºæ–‡æ¡£æ¨¡æ¿segment.docx(ä¸‹å›¾å³ä¾§)ã€‚

image::./example/example_resume_template.png[align='center']
--

çœ‹èµ·æ¥å¾ˆå¤æ‚çš„ç®€å†ï¼Œå…¶å®å¯¹äºæ¨¡ç‰ˆå¼•æ“æ¥è¯´ï¼Œå’Œæ™®é€šçš„Wordæ–‡æ¡£æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ¶ä½œå¥½ä¸€ä»½ç®€å†ï¼Œå°†éœ€è¦æ›¿æ¢çš„å†…å®¹ç”¨æ¨¡ç‰ˆæ ‡ç­¾ä»£æ›¿ã€‚

å› ä¸ºæ¨¡ç‰ˆå³æ ·å¼ï¼Œæ¨¡ç‰ˆå¼•æ“æ— éœ€è€ƒè™‘æ ·å¼ï¼Œåªå…³å¿ƒæ•°æ®ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥åˆ¶ä½œ10ç§ä¸åŒæ ·å¼çš„ç®€å†æ¨¡æ¿ï¼Œç”¨åŒä¸€ä»½æ•°æ®å»æ¸²æŸ“ã€‚

NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/example/ResumeExample.java[JUnit ResumeExample]

[#example-swagger]
=== Swaggeræ–‡æ¡£
[example]
--
.output.docx
è¿™æ˜¯ä¸€ä»½éå¸¸ä¸“ä¸šçš„Swagger Wordæ–‡æ¡£ï¼Œæ ·å¼ä¼˜é›…ä¸”æœ‰ç€æ¸…æ™°å®Œæ•´çš„æ–‡æ¡£ç»“æ„ï¼ŒAPIåˆ—è¡¨éœ€è¦å¾ªç¯å±•ç¤ºï¼Œæ¥å£çš„è¯·æ±‚å‚æ•°éœ€è¦å¾ªç¯å±•ç¤ºï¼Œæ¥å£çš„è¿”å›å€¼éœ€è¦å¾ªç¯å±•ç¤ºï¼Œæ•°æ®ç±»å‹æ”¯æŒé”šç‚¹åˆ°å…·ä½“çš„æ¨¡å‹ï¼Œæ¨¡å‹æ”¯æŒä»£ç å—é«˜äº®å±•ç¤ºã€‚ä¸‹è½½æœ€ç»ˆç”Ÿæˆçš„æ–‡ä»¶link:./example/swagger.docx[swagger.docx]

image::./example/example_swagger_output.png[align='center']
image::./example/example_swagger_output2.png[align='center']
--

[example]
--
.template.docx
ä½¿ç”¨åŒºå—å¯¹æ ‡ç­¾å®Œæˆæ‰€æœ‰å¾ªç¯åŠŸèƒ½ï¼Œå¯ä»¥å®Œç¾çš„æ”¯æŒæœ‰åºå’Œå¤šçº§åˆ—è¡¨ï¼›è¡¨æ ¼ä½¿ç”¨ `LoopRowTableRenderPolicy` æ’ä»¶çš„çº¦å®šï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„å®Œæˆå‚æ•°ã€è¿”å›å€¼ç­‰è¡¨æ ¼çš„æ¸²æŸ“ï¼›ä½¿ç”¨Springè¡¨è¾¾å¼æ¥æ”¯æŒä¸°å¯Œçš„æ¡ä»¶åˆ¤æ–­ï¼›ä»£ç å—é«˜äº®ä½¿ç”¨ `HighlightRenderPolicy` æ’ä»¶ã€‚

image::./example/example_swagger_template1.png[align='center']
image::./example/example_swagger_template2.png[align='center']
--

[example]
--
.ä»£ç ç¤ºä¾‹
[source, java]
----
SwaggerParser swaggerParser = new SwaggerParser();
Swagger swagger = swaggerParser.read("https://petstore.swagger.io/v2/swagger.json");
SwaggerView viewData = convert(swagger); <1>

LoopRowTableRenderPolicy LoopRowTableRenderPolicy = new LoopRowTableRenderPolicy();
Configure config = Configure.builder()
        .bind("parameters", hackLoopTableRenderPolicy)
        .bind("responses", hackLoopTableRenderPolicy)
        .bind("properties", hackLoopTableRenderPolicy)
        .bind("definitionCode", new HighlightRenderPolicy())
        .useSpringEL()
        .build(); <2>

XWPFTemplate template = XWPFTemplate.compile("swagger.docx", config).render(viewData); <3>
template.writeToFile("out_example_swagger.docx");
----
<1> è§£æSwagger.json
<2> é…ç½®æ¨¡æ¿å¼•æ“
<3> Swaggerå¯¼å‡ºWord
--

æ²¡é”™ï¼Œä¸€åˆ‡éƒ½æ˜¯å¦‚æ­¤ç®€æ´ï¼šç®€æ´çš„å¯¼å‡ºä»£ç  ï¼Œç®€æ´çš„Wordæ¨¡æ¿ï¼Œç”šè‡³ç”Ÿæˆçš„Swaggeræ–‡æ¡£éƒ½çœ‹èµ·æ¥é‚£ä¹ˆç®€æ´ï¼Œæ„¿ä¸€åˆ‡å¦‚ä½ æ‰€æ„¿ã€‚

NOTE: æºç å‚è§ link:https://github.com/Sayi/poi-tl/tree/dev-1.10.x/poi-tl/src/test/java/com/deepoove/poi/tl/example/SwaggerToWordExample.java[JUnit SwaggerToWordExample]

== License
Apache License 2.0

== æºç 
link:https://github.com/Sayi/poi-tl[GitHub]

== æ‰“èµä¸ªå°è´¹
poi-tlå¼€æºçš„åˆè¡·æ˜¯å¸Œæœ›è®©æ‰€æœ‰æœ‰éœ€è¦çš„äººäº«å—Wordæ¨¡æ¿å¼•æ“çš„åŠŸèƒ½ï¼Œè€Œä¸”å®ƒå¯èƒ½æ˜¯Javaä¸­æœ€å¥½çš„Wordæ¨¡æ¿å¼•æ“ã€‚

å¦‚æœä½ è§‰å¾—å®ƒèŠ‚çœäº†ä½ çš„æ—¶é—´ï¼Œç»™ä½ å¸¦æ¥äº†æ–¹ä¾¿å’Œçµæ„Ÿï¼Œæˆ–è€…è®¤åŒè¿™ä¸ªå¼€æºé¡¹ç›®ï¼Œå¯ä»¥ä¸ºæˆ‘çš„ä»˜å‡ºæ‰“èµç‚¹å°è´¹å“¦(**åœ¨å¤‡æ³¨ç•™è¨€ä¸­é™„ä¸Šä½ çš„å¾®ä¿¡å·ï¼Œè®©æˆ‘å¯ä»¥åŠ ä¸ªå¥½å‹ï¼Œè¯´å¥æ„Ÿè°¢â¤ï¸**)ã€‚

image::./pay.jpeg[width=256, height=280]

[quote, Sayi]
____
poi-tlæ˜¯ç»™ä½ çš„ç¤¼ç‰©ï¼
____

== å¸¸è§é—®é¢˜
[qanda]
å‡ºç°NoSuchMethodError ã€ClassNotFoundException ã€NoClassDefFoundErrorå¼‚å¸¸ï¼Ÿ::
  poi-tlä¾èµ–çš„apache-poiç‰ˆæœ¬æ˜¯4.1.2+ï¼Œå¦‚æœä½ çš„é¡¹ç›®å¼•ç”¨äº†ä½ç‰ˆæœ¬ï¼Œè¯·å‡çº§æˆ–åˆ é™¤ã€‚
æ˜¯å¦æ”¯æŒAndroidå®¢æˆ·ç«¯ä½¿ç”¨ï¼Ÿ::
  å‚è€ƒlink:https://github.com/Sayi/poi-tl/issues/227[issue227]ã€‚
æœ‰æ²¡æœ‰HTMLè½¬Wordçš„æ’ä»¶ï¼Ÿ::
  å‚è€ƒlink:https://github.com/Sayi/poi-tl/issues/219[issue219]ã€‚
æœ‰æ²¡æœ‰å…¬å¼çš„æ’ä»¶ï¼Ÿ::
  å‚è€ƒlink:https://github.com/Sayi/poi-tl/issues/27[issue27]ã€‚
å¦‚ä½•é€šè¿‡æ ‡ç­¾æŒ‡å®šæ ¼å¼åŒ–å‡½æ•°ï¼Ÿ::
  Springè¡¨è¾¾å¼ï¼Œåº”æœ‰å°½æœ‰ã€‚
å¦‚ä½•åœ¨ä¸€è¡Œä¸­æ˜¾ç¤ºä¸åŒæ ·å¼çš„æ–‡æœ¬ï¼Ÿ::
  å¯èƒ½ä½ éœ€è¦å¤šä¸ªæ ‡ç­¾ï¼›æˆ–è€…ä½¿ç”¨åŒºå—å¯¹ï¼ŒåŒºå—å¯¹çš„é›†åˆæ•°æ®æ˜¯æ‹¥æœ‰ä¸åŒæ ·å¼çš„TextRenderDataï¼Œè¿˜å¯ä»¥è€ƒè™‘ä½¿ç”¨ParagraphRenderPolicyæ’ä»¶ã€‚
æˆ‘ä¸æ˜¯å¾ˆç†Ÿæ‚‰Apache POIï¼Œæˆ‘è¯¥æ€ä¹ˆç¼–å†™æ’ä»¶ï¼Ÿ::
  ç¼–å†™æ’ä»¶è¿˜æ˜¯éœ€è¦ç†Ÿæ‚‰ä¸‹POIï¼Œä½ å¯ä»¥å‚è€ƒç°æœ‰æ’ä»¶çš„æºç ï¼Œæˆ–è€…Googleä¸‹Apache POIçš„ç”¨æ³•ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå…¥é—¨æ•™ç¨‹ï¼šlink:http://deepoove.com/poi-tl/apache-poi-guide.html[Apache POI Wordå¿«é€Ÿå…¥é—¨ , window=_blank]
Apache POIä¸æ”¯æŒçš„åŠŸèƒ½ï¼Œæˆ‘è¯¥æ€ä¹ˆç¼–å†™æ’ä»¶ï¼Ÿ::
  Apache POIåº•å±‚çš„ç»„ä»¶ä¹Ÿæ˜¯ç›´æ¥æ“ä½œXMLçš„ï¼Œä½ å¯ä»¥ä½¿ç”¨POIèƒŒåçš„ç»„ä»¶ã€‚
